{"version":3,"sources":["./src/core/features/user/pages/profile/profile.html","./src/core/features/user/pages/profile/profile.module.ts","./src/core/features/user/pages/profile/profile.page.ts","./src/core/features/user/pages/profile/profile.scss"],"names":[],"mappings":"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","file":"pages-profile-profile-module.js","sourcesContent":["export default \"<ion-header>\\r\\n    <ion-toolbar>\\r\\n        <ion-buttons slot=\\\"start\\\">\\r\\n            <ion-back-button [text]=\\\"'core.back' | translate\\\"></ion-back-button>\\r\\n        </ion-buttons>\\r\\n        <h1 *ngIf=\\\"title\\\">{{ title }}</h1>\\r\\n    </ion-toolbar>\\r\\n</ion-header>\\r\\n<ion-content>\\r\\n    <ion-refresher slot=\\\"fixed\\\" [disabled]=\\\"!userLoaded\\\" (ionRefresh)=\\\"refreshUser($event.target)\\\">\\r\\n        <ion-refresher-content pullingText=\\\"{{ 'core.pulltorefresh' | translate }}\\\"></ion-refresher-content>\\r\\n    </ion-refresher>\\r\\n    <core-loading [hideUntil]=\\\"userLoaded\\\">\\r\\n        <ion-list *ngIf=\\\"user && !isDeleted && isEnrolled\\\">\\r\\n            <ion-item class=\\\"ion-text-center core-user-profile-maininfo\\\">\\r\\n                <core-user-avatar [user]=\\\"user\\\" [userId]=\\\"user.id\\\" [linkProfile]=\\\"false\\\" [checkOnline]=\\\"true\\\">\\r\\n                    <ion-button\\r\\n                        class=\\\"edit-avatar\\\"\\r\\n                        *ngIf=\\\"canChangeProfilePicture\\\"\\r\\n                        (click)=\\\"changeProfilePicture()\\\"\\r\\n                        [attr.aria-label]=\\\"'core.user.newpicture' | translate\\\"\\r\\n                        fill=\\\"clear\\\"\\r\\n                        color=\\\"dark\\\"\\r\\n                    >\\r\\n                        <ion-icon slot=\\\"icon-only\\\" name=\\\"fas-pen\\\" aria-hidden=\\\"true\\\"></ion-icon>\\r\\n                    </ion-button>\\r\\n                </core-user-avatar>\\r\\n                <ion-label>\\r\\n                    <h2>{{ user.fullname }}</h2>\\r\\n                    <p *ngIf=\\\"user.address\\\">{{ user.address }}</p>\\r\\n                    <p *ngIf=\\\"rolesFormatted\\\" class=\\\"ion-text-wrap\\\">\\r\\n                        <strong>{{ 'core.user.roles' | translate}}</strong>{{'core.labelsep' | translate}}\\r\\n                        {{ rolesFormatted }}\\r\\n                    </p>\\r\\n                </ion-label>\\r\\n            </ion-item>\\r\\n\\r\\n            <div class=\\\"core-user-communication-handlers\\\"\\r\\n                *ngIf=\\\"(communicationHandlers && communicationHandlers.length) || isLoadingHandlers\\\">\\r\\n                <ion-item *ngIf=\\\"communicationHandlers && communicationHandlers.length\\\">\\r\\n                    <ion-label>\\r\\n                        <ion-button *ngFor=\\\"let handler of communicationHandlers\\\" expand=\\\"block\\\" size=\\\"default\\\"\\r\\n                            [ngClass]=\\\"['core-user-profile-handler', handler.class || '']\\\" (click)=\\\"handlerClicked($event, handler)\\\"\\r\\n                            [hidden]=\\\"handler.hidden\\\" [attr.aria-label]=\\\"handler.title | translate\\\" [disabled]=\\\"handler.spinner\\\">\\r\\n                            <ion-icon *ngIf=\\\"handler.icon\\\" [name]=\\\"handler.icon\\\" slot=\\\"start\\\" aria-hidden=\\\"true\\\"></ion-icon>\\r\\n                            {{ handler.title | translate }}\\r\\n                        </ion-button>\\r\\n                    </ion-label>\\r\\n                </ion-item>\\r\\n                <div *ngIf=\\\"isLoadingHandlers\\\" class=\\\"ion-text-center core-loading-handlers\\\">\\r\\n                    <ion-spinner [attr.aria-label]=\\\"'core.loading' | translate\\\"></ion-spinner>\\r\\n                </div>\\r\\n            </div>\\r\\n\\r\\n\\r\\n            <ion-item button class=\\\"ion-text-wrap core-user-profile-handler\\\" (click)=\\\"openUserDetails()\\\"\\r\\n                [attr.aria-label]=\\\"'core.user.details' | translate\\\" detail=\\\"true\\\">\\r\\n                <ion-icon name=\\\"fas-user\\\" slot=\\\"start\\\" aria-hidden=\\\"true\\\"></ion-icon>\\r\\n                <ion-label>\\r\\n                    <p class=\\\"item-heading\\\">{{ 'core.user.details' | translate }}</p>\\r\\n                </ion-label>\\r\\n            </ion-item>\\r\\n            <ion-item class=\\\"ion-text-center core-loading-handlers\\\" *ngIf=\\\"isLoadingHandlers\\\">\\r\\n                <ion-label><ion-spinner [attr.aria-label]=\\\"'core.loading' | translate\\\"></ion-spinner></ion-label>\\r\\n            </ion-item>\\r\\n\\r\\n            <ion-item button *ngFor=\\\"let handler of newPageHandlers\\\" class=\\\"ion-text-wrap\\\" (click)=\\\"handlerClicked($event, handler)\\\"\\r\\n                [ngClass]=\\\"['core-user-profile-handler', handler.class || '']\\\" [hidden]=\\\"handler.hidden\\\"\\r\\n                [attr.aria-label]=\\\"handler.title | translate\\\" detail=\\\"true\\\">\\r\\n                <ion-icon *ngIf=\\\"handler.icon\\\" [name]=\\\"handler.icon\\\" slot=\\\"start\\\" aria-hidden=\\\"true\\\"></ion-icon>\\r\\n                <ion-label>\\r\\n                    <p class=\\\"item-heading\\\">{{ handler.title | translate }}</p>\\r\\n                </ion-label>\\r\\n            </ion-item>\\r\\n\\r\\n            <ion-item *ngIf=\\\"actionHandlers && actionHandlers.length\\\">\\r\\n                <ion-label>\\r\\n                    <ion-button *ngFor=\\\"let handler of actionHandlers\\\" expand=\\\"block\\\" fill=\\\"outline\\\" size=\\\"default\\\"\\r\\n                        [ngClass]=\\\"['core-user-profile-handler', handler.class || '']\\\" (click)=\\\"handlerClicked($event, handler)\\\"\\r\\n                        [hidden]=\\\"handler.hidden\\\" [attr.aria-label]=\\\"handler.title | translate\\\" [disabled]=\\\"handler.spinner\\\">\\r\\n                        <ion-icon *ngIf=\\\"handler.icon\\\" [name]=\\\"handler.icon\\\" slot=\\\"start\\\" aria-hidden=\\\"true\\\"></ion-icon>\\r\\n                        {{ handler.title | translate }}\\r\\n                        <ion-spinner *ngIf=\\\"handler.spinner\\\" slot=\\\"end\\\" [attr.aria-label]=\\\"'core.loading' | translate\\\"></ion-spinner>\\r\\n                    </ion-button>\\r\\n                </ion-label>\\r\\n            </ion-item>\\r\\n        </ion-list>\\r\\n\\r\\n        <core-empty-box *ngIf=\\\"!user && !isDeleted && isEnrolled\\\" icon=\\\"far-user\\\"\\r\\n            [message]=\\\" 'core.user.detailsnotavailable' | translate\\\">\\r\\n        </core-empty-box>\\r\\n        <core-empty-box *ngIf=\\\"isDeleted\\\" icon=\\\"far-user\\\" [message]=\\\"'core.userdeleted' | translate\\\"></core-empty-box>\\r\\n        <core-empty-box *ngIf=\\\"!isEnrolled\\\" icon=\\\"far-user\\\" [message]=\\\"'core.notenrolledprofile' | translate\\\"></core-empty-box>\\r\\n    </core-loading>\\r\\n</ion-content>\\r\\n\";","// (C) Copyright 2015 Moodle Pty Ltd.\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\n\r\nimport { CoreSharedModule } from '@/core/shared.module';\r\nimport { CoreUserProfilePage } from './profile.page';\r\n\r\nconst routes: Routes = [\r\n    {\r\n        path: '',\r\n        component: CoreUserProfilePage,\r\n    },\r\n];\r\n\r\n@NgModule({\r\n    imports: [\r\n        RouterModule.forChild(routes),\r\n        CoreSharedModule,\r\n    ],\r\n    declarations: [\r\n        CoreUserProfilePage,\r\n    ],\r\n    exports: [RouterModule],\r\n})\r\nexport class CoreUserProfilePageModule {}\r\n","// (C) Copyright 2015 Moodle Pty Ltd.\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { IonRefresher } from '@ionic/angular';\r\nimport { Subscription } from 'rxjs';\r\n\r\nimport { CoreSite } from '@classes/site';\r\nimport { CoreSites } from '@services/sites';\r\nimport { CoreDomUtils } from '@services/utils/dom';\r\nimport { CoreMimetypeUtils } from '@services/utils/mimetype';\r\nimport { Translate } from '@singletons';\r\nimport { CoreEventObserver, CoreEvents } from '@singletons/events';\r\nimport {\r\n    CoreUser,\r\n    CoreUserProfile,\r\n    CoreUserProvider,\r\n} from '@features/user/services/user';\r\nimport { CoreUserHelper } from '@features/user/services/user-helper';\r\nimport { CoreUserDelegate, CoreUserDelegateService, CoreUserProfileHandlerData } from '@features/user/services/user-delegate';\r\nimport { CoreFileUploaderHelper } from '@features/fileuploader/services/fileuploader-helper';\r\nimport { CoreIonLoadingElement } from '@classes/ion-loading';\r\nimport { CoreUtils } from '@services/utils/utils';\r\nimport { CoreNavigator } from '@services/navigator';\r\nimport { CoreCourses } from '@features/courses/services/courses';\r\n\r\n@Component({\r\n    selector: 'page-core-user-profile',\r\n    templateUrl: 'profile.html',\r\n    styleUrls: ['profile.scss'],\r\n})\r\nexport class CoreUserProfilePage implements OnInit, OnDestroy {\r\n\r\n    protected courseId?: number;\r\n    protected userId!: number;\r\n    protected site?: CoreSite;\r\n    protected obsProfileRefreshed: CoreEventObserver;\r\n    protected subscription?: Subscription;\r\n\r\n    userLoaded = false;\r\n    isLoadingHandlers = false;\r\n    user?: CoreUserProfile;\r\n    title?: string;\r\n    isDeleted = false;\r\n    isEnrolled = true;\r\n    canChangeProfilePicture = false;\r\n    rolesFormatted?: string;\r\n    actionHandlers: CoreUserProfileHandlerData[] = [];\r\n    newPageHandlers: CoreUserProfileHandlerData[] = [];\r\n    communicationHandlers: CoreUserProfileHandlerData[] = [];\r\n\r\n    constructor() {\r\n        this.obsProfileRefreshed = CoreEvents.on(CoreUserProvider.PROFILE_REFRESHED, (data) => {\r\n            if (!this.user || !data.user) {\r\n                return;\r\n            }\r\n\r\n            this.user.email = data.user.email;\r\n            this.user.address = CoreUserHelper.formatAddress('', data.user.city, data.user.country);\r\n        }, CoreSites.getCurrentSiteId());\r\n    }\r\n\r\n    /**\r\n     * On init.\r\n     */\r\n    async ngOnInit(): Promise<void> {\r\n        this.site = CoreSites.getCurrentSite();\r\n        this.courseId = CoreNavigator.getRouteNumberParam('courseId');\r\n        const userId = CoreNavigator.getRouteNumberParam('userId');\r\n\r\n        if (!this.site) {\r\n            return;\r\n        }\r\n        if (userId === undefined) {\r\n            CoreDomUtils.showErrorModal('User ID not supplied');\r\n            CoreNavigator.back();\r\n\r\n            return;\r\n        }\r\n\r\n        this.userId = userId;\r\n\r\n        // Allow to change the profile image only in the app profile page.\r\n        this.canChangeProfilePicture =\r\n            (!this.courseId || this.courseId == this.site.getSiteHomeId()) &&\r\n            this.userId == this.site.getUserId() &&\r\n            this.site.canUploadFiles() &&\r\n            CoreUser.canUpdatePictureInSite(this.site) &&\r\n            !CoreUser.isUpdatePictureDisabledInSite(this.site);\r\n\r\n        try {\r\n            await this.fetchUser();\r\n\r\n            try {\r\n                await CoreUser.logView(this.userId, this.courseId, this.user!.fullname);\r\n            } catch (error) {\r\n                this.isDeleted = error?.errorcode === 'userdeleted';\r\n                this.isEnrolled = error?.errorcode !== 'notenrolledprofile';\r\n            }\r\n        } finally {\r\n            this.userLoaded = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Fetches the user and updates the view.\r\n     */\r\n    async fetchUser(): Promise<void> {\r\n        try {\r\n            const user = await CoreUser.getProfile(this.userId, this.courseId);\r\n\r\n            user.address = CoreUserHelper.formatAddress('', user.city, user.country);\r\n            this.rolesFormatted = 'roles' in user ? CoreUserHelper.formatRoleList(user.roles) : '';\r\n\r\n            this.user = user;\r\n            this.title = user.fullname;\r\n\r\n            // If there's already a subscription, unsubscribe because we'll get a new one.\r\n            this.subscription?.unsubscribe();\r\n\r\n            this.subscription = CoreUserDelegate.getProfileHandlersFor(user, this.courseId).subscribe((handlers) => {\r\n                this.actionHandlers = [];\r\n                this.newPageHandlers = [];\r\n                this.communicationHandlers = [];\r\n                handlers.forEach((handler) => {\r\n                    switch (handler.type) {\r\n                        case CoreUserDelegateService.TYPE_COMMUNICATION:\r\n                            this.communicationHandlers.push(handler.data);\r\n                            break;\r\n                        case CoreUserDelegateService.TYPE_ACTION:\r\n                            this.actionHandlers.push(handler.data);\r\n                            break;\r\n                        case CoreUserDelegateService.TYPE_NEW_PAGE:\r\n                        default:\r\n                            this.newPageHandlers.push(handler.data);\r\n                            break;\r\n                    }\r\n                });\r\n\r\n                this.isLoadingHandlers = !CoreUserDelegate.areHandlersLoaded(user.id);\r\n            });\r\n\r\n            await this.checkUserImageUpdated();\r\n\r\n        } catch (error) {\r\n            // Error is null for deleted users, do not show the modal.\r\n            CoreDomUtils.showErrorModal(error);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Check if current user image has changed.\r\n     *\r\n     * @return Promise resolved when done.\r\n     */\r\n    protected async checkUserImageUpdated(): Promise<void> {\r\n        if (!this.site || !this.site.getInfo() || !this.user) {\r\n            return;\r\n        }\r\n\r\n        if (this.userId != this.site.getUserId() || !this.isUserAvatarDirty()) {\r\n            // Not current user or hasn't changed.\r\n            return;\r\n        }\r\n\r\n        // The current user image received is different than the one stored in site info. Assume the image was updated.\r\n        // Update the site info to get the right avatar in there.\r\n        try {\r\n            await CoreSites.updateSiteInfo(this.site.getId());\r\n        } catch {\r\n            // Cannot update site info. Assume the profile image is the right one.\r\n            CoreEvents.trigger(CoreUserProvider.PROFILE_PICTURE_UPDATED, {\r\n                userId: this.userId,\r\n                picture: this.user.profileimageurl,\r\n            }, this.site.getId());\r\n        }\r\n\r\n        if (this.isUserAvatarDirty()) {\r\n            // The image is still different, this means that the good one is the one in site info.\r\n            await this.refreshUser();\r\n        } else {\r\n            // Now they're the same, send event to use the right avatar in the rest of the app.\r\n            CoreEvents.trigger(CoreUserProvider.PROFILE_PICTURE_UPDATED, {\r\n                userId: this.userId,\r\n                picture: this.user.profileimageurl,\r\n            }, this.site.getId());\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Opens dialog to change profile picture.\r\n     */\r\n    async changeProfilePicture(): Promise<void> {\r\n        const maxSize = -1;\r\n        const title = Translate.instant('core.user.newpicture');\r\n        const mimetypes = CoreMimetypeUtils.getGroupMimeInfo('image', 'mimetypes');\r\n        let modal: CoreIonLoadingElement | undefined;\r\n\r\n        try {\r\n            const result = await CoreFileUploaderHelper.selectAndUploadFile(maxSize, title, mimetypes);\r\n\r\n            modal = await CoreDomUtils.showModalLoading('core.sending', true);\r\n\r\n            const profileImageURL = await CoreUser.changeProfilePicture(result.itemid, this.userId, this.site!.getId());\r\n\r\n            CoreEvents.trigger(CoreUserProvider.PROFILE_PICTURE_UPDATED, {\r\n                userId: this.userId,\r\n                picture: profileImageURL,\r\n            }, this.site!.getId());\r\n\r\n            CoreSites.updateSiteInfo(this.site!.getId());\r\n\r\n            this.refreshUser();\r\n        } catch (error) {\r\n            CoreDomUtils.showErrorModal(error);\r\n        } finally {\r\n            modal?.dismiss();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Refresh the user.\r\n     *\r\n     * @param event Event.\r\n     * @return Promise resolved when done.\r\n     */\r\n    async refreshUser(event?: IonRefresher): Promise<void> {\r\n        await CoreUtils.ignoreErrors(Promise.all([\r\n            CoreUser.invalidateUserCache(this.userId),\r\n            CoreCourses.invalidateUserNavigationOptions(),\r\n            CoreCourses.invalidateUserAdministrationOptions(),\r\n        ]));\r\n\r\n        await this.fetchUser();\r\n\r\n        event?.complete();\r\n\r\n        if (this.user) {\r\n            CoreEvents.trigger(CoreUserProvider.PROFILE_REFRESHED, {\r\n                courseId: this.courseId,\r\n                userId: this.userId,\r\n                user: this.user,\r\n            }, this.site?.getId());\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Open the page with the user details.\r\n     */\r\n    openUserDetails(): void {\r\n        CoreNavigator.navigateToSitePath('user/about', {\r\n            params: {\r\n                courseId: this.courseId,\r\n                userId: this.userId,\r\n            },\r\n        });\r\n    }\r\n\r\n    /**\r\n     * A handler was clicked.\r\n     *\r\n     * @param event Click event.\r\n     * @param handler Handler that was clicked.\r\n     */\r\n    handlerClicked(event: Event, handler: CoreUserProfileHandlerData): void {\r\n        handler.action(event, this.user!, this.courseId);\r\n    }\r\n\r\n    /**\r\n     * Page destroyed.\r\n     */\r\n    ngOnDestroy(): void {\r\n        this.subscription?.unsubscribe();\r\n        this.obsProfileRefreshed.off();\r\n    }\r\n\r\n    /**\r\n     * Check whether the user avatar is not up to date with site info.\r\n     *\r\n     * @return Whether the user avatar differs from site info cache.\r\n     */\r\n    private isUserAvatarDirty(): boolean {\r\n        if (!this.user || !this.site) {\r\n            return false;\r\n        }\r\n\r\n        const courseAvatarUrl = this.normalizeAvatarUrl(this.user.profileimageurl);\r\n        const siteAvatarUrl = this.normalizeAvatarUrl(this.site.getInfo()?.userpictureurl);\r\n\r\n        return courseAvatarUrl !== siteAvatarUrl;\r\n    }\r\n\r\n    /**\r\n     * Normalize an avatar url regardless of theme.\r\n     *\r\n     * Given that the default image is the only one that can be changed per theme, any other url will stay the same. Note that\r\n     * the values returned by this function may not be valid urls, given that they are intended for string comparison.\r\n     *\r\n     * @param avatarUrl Avatar url.\r\n     * @return Normalized avatar string (may not be a valid url).\r\n     */\r\n    private normalizeAvatarUrl(avatarUrl?: string): string {\r\n        if (!avatarUrl) {\r\n            return 'undefined';\r\n        }\r\n\r\n        if (avatarUrl.startsWith(`${this.site?.siteUrl}/theme/image.php`)) {\r\n            return 'default';\r\n        }\r\n\r\n        return avatarUrl;\r\n    }\r\n\r\n}\r\n","export default \":host .core-user-profile-maininfo::part(native) {\\n  flex-direction: column;\\n}\\n:host ::ng-deep core-user-avatar {\\n  display: block;\\n  --core-avatar-size: var(--core-large-avatar-size);\\n  height: calc(var(--core-avatar-size) + 16px);\\n}\\n:host ::ng-deep core-user-avatar img {\\n  margin: 8px auto;\\n}\\n:host ::ng-deep core-user-avatar .contact-status {\\n  width: 24px !important;\\n  height: 24px !important;\\n  right: calc(50% - 12px - var(--core-avatar-size) / 2) !important;\\n}\\n:host ::ng-deep core-user-avatar .edit-avatar {\\n  position: absolute;\\n  right: calc(50% - 15px - var(--core-avatar-size) / 2);\\n  bottom: -12px;\\n}\\n:host-context([dir=rtl]) :host ::ng-deep core-user-avatar .edit-avatar {\\n  left: 0;\\n  right: unset;\\n}\\n:host ::ng-deep core-user-avatar .edit-avatar::part(native) {\\n  border-radius: 50%;\\n  background: var(--ion-item-background);\\n}\\n:host-context([dir=rtl]) ::ng-deep core-user-avatar .edit-avatar {\\n  left: -24px;\\n  right: unset;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9jb3JlL2ZlYXR1cmVzL3VzZXIvcGFnZXMvcHJvZmlsZS9wcm9maWxlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUk7RUFDSSxzQkFBQTtBQURSO0FBSVE7RUFDSSxjQUFBO0VBQ0EsaURBQUE7RUFDQSw0Q0FBQTtBQUZaO0FBSVk7RUFDSSxnQkFBQTtBQUZoQjtBQUtZO0VBQ0ksc0JBQUE7RUFDQSx1QkFBQTtFQUNBLGdFQUFBO0FBSGhCO0FBTVk7RUFDSSxrQkFBQTtFQUNBLHFEQUFBO0VBQ0EsYUFBQTtBQUpoQjtBQU1nQjtFQUNJLE9BQUE7RUFDQSxZQUFBO0FBSnBCO0FBTWdCO0VBQ0ksa0JBQUE7RUFDQSxzQ0FBQTtBQUpwQjtBQVlBO0VBQ0ksV0FBQTtFQUNBLFlBQUE7QUFUSiIsImZpbGUiOiJzcmMvY29yZS9mZWF0dXJlcy91c2VyL3BhZ2VzL3Byb2ZpbGUvcHJvZmlsZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiOmhvc3Qge1xyXG5cclxuICAgIC5jb3JlLXVzZXItcHJvZmlsZS1tYWluaW5mbzo6cGFydChuYXRpdmUpIHtcclxuICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAgfVxyXG4gICAgOjpuZy1kZWVwIHtcclxuICAgICAgICBjb3JlLXVzZXItYXZhdGFyIHtcclxuICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7XHJcbiAgICAgICAgICAgIC0tY29yZS1hdmF0YXItc2l6ZTogdmFyKC0tY29yZS1sYXJnZS1hdmF0YXItc2l6ZSk7XHJcbiAgICAgICAgICAgIGhlaWdodDogY2FsYyh2YXIoLS1jb3JlLWF2YXRhci1zaXplKSArIDE2cHgpO1xyXG5cclxuICAgICAgICAgICAgaW1nIHtcclxuICAgICAgICAgICAgICAgIG1hcmdpbjogOHB4IGF1dG87XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC5jb250YWN0LXN0YXR1cyB7XHJcbiAgICAgICAgICAgICAgICB3aWR0aDogMjRweCAhaW1wb3J0YW50O1xyXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAyNHB4ICFpbXBvcnRhbnQ7XHJcbiAgICAgICAgICAgICAgICByaWdodDogY2FsYyg1MCUgLSAxMnB4IC0gIHZhcigtLWNvcmUtYXZhdGFyLXNpemUpIC8gMikgIWltcG9ydGFudDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLmVkaXQtYXZhdGFyIHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgICAgICAgICAgICAgIHJpZ2h0OiBjYWxjKDUwJSAtIDE1cHggLSAgdmFyKC0tY29yZS1hdmF0YXItc2l6ZSkgLyAyKTtcclxuICAgICAgICAgICAgICAgIGJvdHRvbTogLTEycHg7XHJcblxyXG4gICAgICAgICAgICAgICAgOmhvc3QtY29udGV4dChbZGlyPVwicnRsXCJdKSAmIHtcclxuICAgICAgICAgICAgICAgICAgICBsZWZ0OiAwO1xyXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0OiB1bnNldDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICY6OnBhcnQobmF0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWlvbi1pdGVtLWJhY2tncm91bmQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxufVxyXG5cclxuOmhvc3QtY29udGV4dChbZGlyPVwicnRsXCJdKSA6Om5nLWRlZXAgY29yZS11c2VyLWF2YXRhciAuZWRpdC1hdmF0YXIge1xyXG4gICAgbGVmdDogLTI0cHg7XHJcbiAgICByaWdodDogdW5zZXQ7XHJcbn1cclxuIl19 */\";"],"sourceRoot":"webpack:///"}