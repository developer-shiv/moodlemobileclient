{"version":3,"sources":["./src/addons/mod/lesson/pages/user-retake/user-retake.html","./src/addons/mod/lesson/pages/user-retake/user-retake.module.ts","./src/addons/mod/lesson/pages/user-retake/user-retake.page.ts","./src/addons/mod/lesson/pages/user-retake/user-retake.scss"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAe,2QAA4M,gDAAgD,uNAAuN,oCAAoC,iiBAAiiB,kBAAkB,ocAAoc,gDAAgD,0QAA0Q,qDAAqD,6IAA6I,cAAc,ukBAAukB,wCAAwC,kDAAkD,sCAAsC,2BAA2B,GAAG,wKAAwK,2CAA2C,kDAAkD,qCAAqC,KAAK,oCAAoC,wVAAwV,4CAA4C,sCAAsC,qBAAqB,yNAAyN,4CAA4C,sCAAsC,sDAAsD,iTAAiT,+CAA+C,qYAAqY,4BAA4B,kHAAkH,YAAY,IAAI,YAAY,wOAAwO,2CAA2C,ysBAAysB,yCAAyC,0VAA0V,uDAAuD,w9BAAw9B,wBAAwB,25BAA25B,kDAAkD,muDAAmuD,mBAAmB,i0DAAi0D,iBAAiB,y/HAAy/H,2CAA2C,ksBAAksB,uBAAuB,mNAAmN,E;;;;;;;;;;;;ACAzlhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qCAAqC;AACrC,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,iDAAiD;AACjD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;;AAEQ;AACc;AAEC;AACU;AAElE,MAAM,MAAM,GAAW;IACnB;QACI,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,8EAA4B;KAC1C;CACJ,CAAC;IAYW,kCAAkC,SAAlC,kCAAkC;CAAG;AAArC,kCAAkC;IAV9C,8DAAQ,CAAC;QACN,OAAO,EAAE;YACL,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC;YAC7B,oEAAgB;SACnB;QACD,YAAY,EAAE;YACV,8EAA4B;SAC/B;QACD,OAAO,EAAE,CAAC,4DAAY,CAAC;KAC1B,CAAC;GACW,kCAAkC,CAAG;AAAH;;;;;;;;;;;;;ACrC/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qCAAqC;AACrC,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,iDAAiD;AACjD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;;AAEiB;AAGA;AACM;AACJ;AACR;AACO;AACE;AACH;AACV;AAUT;AAC+D;AACzC;AAErD;;GAEG;IAMU,4BAA4B,SAA5B,4BAA4B;;QAErC,cAAS,GAAG,wEAAsB,CAAC,SAAS,CAAC;IA6LjD,CAAC;IA/KG;;OAEG;IACH,QAAQ;QACJ,IAAI,CAAC,IAAI,GAAG,iEAAa,CAAC,mBAAmB,CAAC,MAAM,CAAE,CAAC;QACvD,IAAI,CAAC,QAAQ,GAAG,iEAAa,CAAC,mBAAmB,CAAC,UAAU,CAAE,CAAC;QAC/D,IAAI,CAAC,MAAM,GAAG,iEAAa,CAAC,mBAAmB,CAAC,QAAQ,CAAC,IAAI,yDAAS,CAAC,oBAAoB,EAAE,CAAC;QAC9F,IAAI,CAAC,YAAY,GAAG,iEAAa,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC;QAEhE,kBAAkB;QAClB,IAAI,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,GAAG,EAAE;YAC1B,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;QACvB,CAAC,CAAC,CAAC;IACP,CAAC;IAED;;;;OAIG;IACG,YAAY,CAAC,YAAoB;;YACnC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;YAEpB,IAAI;gBACA,MAAM,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC;aACtC;YAAC,OAAO,KAAK,EAAE;gBACZ,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,sBAAsB,CAAC;gBAClD,gEAAY,CAAC,cAAc,CAAC,+DAAS,CAAC,yBAAyB,CAAC,KAAK,EAAE,wBAAwB,CAAC,CAAC,CAAC;aACrG;oBAAS;gBACN,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;aACtB;QACL,CAAC;KAAA;IAED;;;;OAIG;IACH,SAAS,CAAC,SAAuB;QAC7B,IAAI,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,GAAG,EAAE;YAC5B,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,QAAQ,GAAG;QAC1B,CAAC,CAAC,CAAC;IACP,CAAC;IAED;;;;OAIG;IACa,SAAS;;;YACrB,IAAI;gBACA,IAAI,CAAC,MAAM,GAAG,MAAM,gEAAc,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;gBAEvE,iDAAiD;gBACjD,MAAM,IAAI,GAAG,MAAM,gEAAc,CAAC,kBAAkB,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,EAAE;oBACjE,IAAI,EAAE,IAAI,CAAC,IAAI;iBAClB,CAAC,CAAC;gBAEH,sBAAsB;gBACtB,MAAM,OAAO,SAA4B,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,QAAQ,0CAAE,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,OAAO,CAAC,EAAE,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC;gBACpG,IAAI,CAAC,OAAO,EAAE;oBACV,qBAAqB;oBACrB,MAAM,IAAI,+DAAS,CAAC,qDAAS,CAAC,OAAO,CAAC,iCAAiC,CAAC,CAAC,CAAC;iBAC7E;gBAED,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,MAAM,EAAE;oBAC1B,cAAc;oBACd,MAAM,IAAI,+DAAS,CAAC,qDAAS,CAAC,OAAO,CAAC,oCAAoC,CAAC,CAAC,CAAC;iBAChF;gBAED,OAAO,CAAC,SAAS,GAAG,kEAAa,CAAC,eAAe,CAAC,OAAO,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;gBACxE,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,MAAM,EAAE,EAAE;oBAChC,IAAI,CAAC,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,YAAY,IAAI,MAAM,CAAC,GAAG,EAAE;wBACzD,oDAAoD;wBACpD,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC;qBAC3C;oBAED,MAAM,CAAC,KAAK,GAAG,6EAAoB,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;gBAC/D,CAAC,CAAC,CAAC;gBAEH,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;oBACtB,iEAAiE;oBACjE,IAAI,CAAC,cAAc,GAAG,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC;iBAC3E;gBAED,qCAAqC;gBACrC,MAAM,IAAI,GAAG,MAAM,+DAAS,CAAC,YAAY,CAAC,qEAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC,CAAC;gBAEhG,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;gBACvB,IAAI,CAAC,OAAO,CAAC,eAAe,GAAG,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,eAAe,CAAC;gBAErD,MAAM,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;aAC7C;YAAC,OAAO,KAAK,EAAE;gBACZ,gEAAY,CAAC,qBAAqB,CAAC,KAAK,EAAE,qBAAqB,EAAE,IAAI,CAAC,CAAC;aAC1E;;KACJ;IAED;;;;OAIG;IACa,WAAW;;YACvB,MAAM,QAAQ,GAAoB,EAAE,CAAC;YAErC,QAAQ,CAAC,IAAI,CAAC,gEAAc,CAAC,oBAAoB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;YAClE,IAAI,IAAI,CAAC,MAAM,EAAE;gBACb,QAAQ,CAAC,IAAI,CAAC,gEAAc,CAAC,yBAAyB,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;gBACxE,QAAQ,CAAC,IAAI,CAAC,gEAAc,CAAC,4BAA4B,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;aAC3F;YAED,MAAM,+DAAS,CAAC,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC;YAEpD,MAAM,IAAI,CAAC,SAAS,EAAE,CAAC;QAC3B,CAAC;KAAA;IAED;;;;;OAKG;IACa,SAAS,CAAC,YAAoB;;YAC1C,IAAI,CAAC,cAAc,GAAG,YAAY,CAAC;YAEnC,MAAM,UAAU,GAAG,MAAM,gEAAc,CAAC,aAAa,CAAC,IAAI,CAAC,MAAO,CAAC,EAAE,EAAE,YAAY,EAAE;gBACjF,IAAI,EAAE,IAAI,CAAC,IAAI;gBACf,MAAM,EAAE,IAAI,CAAC,MAAM;aACtB,CAAC,CAAC;YAEH,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;YAC5C,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,cAAc,CAAC;QACtD,CAAC;KAAA;IAED;;;;;OAKG;IACO,YAAY,CAAC,UAAkD;QACrE,MAAM,aAAa,GAAqB,UAAU,CAAC;QAEnD,IAAI,aAAa,CAAC,SAAS,CAAC,SAAS,EAAE;YACnC,aAAa;YACb,aAAa,CAAC,SAAS,CAAC,KAAK,GAAG,kEAAa,CAAC,eAAe,CAAC,aAAa,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YAChG,IAAI,CAAC,iBAAiB,GAAG,mEAAa,CAAC,UAAU,CAAC,aAAa,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;SACzF;QAED,qBAAqB;QACrB,aAAa,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,EAAE;;YACvC,IAAI,gEAAc,CAAC,mBAAmB,CAAC,IAAI,CAAC,EAAE;gBAC1C,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;gBAEtB,UAAI,IAAI,CAAC,UAAU,0CAAE,OAAO,EAAE;oBAC1B,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM,EAAE,EAAE;wBACvC,6DAA6D;wBAC7D,MAAM,CAAC,CAAC,CAAC,GAAG,6EAAoB,CAAC,gCAAgC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;oBACjF,CAAC,CAAC,CAAC;iBACN;aACJ;iBAAM,IAAI,gEAAc,CAAC,oBAAoB,CAAC,IAAI,CAAC,EAAE;gBAClD,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;gBAEvB,UAAI,IAAI,CAAC,UAAU,0CAAE,OAAO,EAAE;oBAC1B,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM,EAAE,EAAE;wBACvC,kEAAkE;wBAClE,MAAM,CAAC,CAAC,CAAC,GAAG,6EAAoB,CAAC,iCAAiC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;oBAClF,CAAC,CAAC,CAAC;iBACN;aACJ;QACL,CAAC,CAAC,CAAC;QAEH,OAAO,aAAa,CAAC;IACzB,CAAC;CAEJ;AA/LY,4BAA4B;IALxC,+DAAS,CAAC;QACP,QAAQ,EAAE,mCAAmC;QAC7C,6OAA+B;;KAElC,CAAC;GACW,4BAA4B,CA+LxC;AA/LwC;;;;;;;;;;;;;AC9CzC;AAAe,wFAAyB,iBAAiB,GAAG,qCAAqC,oCAAoC,GAAG,8FAA8F,4BAA4B,GAAG,8CAA8C,iBAAiB,GAAG,6CAA6C,+0BAA+0B,E","file":"pages-user-retake-user-retake-module.js","sourcesContent":["export default \"<ion-header>\\r\\n    <ion-toolbar>\\r\\n        <ion-buttons slot=\\\"start\\\">\\r\\n            <ion-back-button [text]=\\\"'core.back' | translate\\\"></ion-back-button>\\r\\n        </ion-buttons>\\r\\n        <h1>{{ 'addon.mod_lesson.detailedstats' | translate }}</h1>\\r\\n    </ion-toolbar>\\r\\n</ion-header>\\r\\n<ion-content>\\r\\n    <ion-refresher slot=\\\"fixed\\\" [disabled]=\\\"!loaded\\\" (ionRefresh)=\\\"doRefresh($event.target)\\\">\\r\\n        <ion-refresher-content pullingText=\\\"{{ 'core.pulltorefresh' | translate }}\\\"></ion-refresher-content>\\r\\n    </ion-refresher>\\r\\n\\r\\n    <core-loading [hideUntil]=\\\"loaded\\\">\\r\\n        <div *ngIf=\\\"student\\\">\\r\\n            <!-- Student data. -->\\r\\n            <ion-item class=\\\"ion-text-wrap\\\" core-user-link [userId]=\\\"student.id\\\" [courseId]=\\\"courseId\\\" [attr.aria-label]=\\\"student.fullname\\\">\\r\\n                <core-user-avatar [user]=\\\"student\\\" slot=\\\"start\\\" [userId]=\\\"student.id\\\" [courseId]=\\\"courseId\\\">\\r\\n                </core-user-avatar>\\r\\n                <ion-label>\\r\\n                    <h2>{{student.fullname}}</h2>\\r\\n                    <core-progress-bar [progress]=\\\"student.bestgrade\\\" a11yText=\\\"addon.mod_lesson.grade\\\"></core-progress-bar>\\r\\n                </ion-label>\\r\\n            </ion-item>\\r\\n\\r\\n            <!-- Retake selector if there is more than one retake. -->\\r\\n            <ion-item class=\\\"ion-text-wrap\\\" *ngIf=\\\"student.attempts && student.attempts.length > 1\\\">\\r\\n                <ion-label id=\\\"addon-mod_lesson-retakeslabel\\\">{{ 'addon.mod_lesson.attemptheader' | translate }}</ion-label>\\r\\n                <ion-select [(ngModel)]=\\\"selectedRetake\\\" (ionChange)=\\\"changeRetake(selectedRetake!)\\\"\\r\\n                    aria-labelledby=\\\"addon-mod_lesson-retakeslabel\\\" interface=\\\"action-sheet\\\"\\r\\n                    [interfaceOptions]=\\\"{header: 'addon.mod_lesson.attemptheader' | translate}\\\">\\r\\n                    <ion-select-option *ngFor=\\\"let retake of student.attempts\\\" [value]=\\\"retake.try\\\">\\r\\n                        {{retake.label}}\\r\\n                    </ion-select-option>\\r\\n                </ion-select>\\r\\n            </ion-item>\\r\\n\\r\\n            <!-- Retake stats. -->\\r\\n            <ion-list *ngIf=\\\"retake && retake.userstats && retake.userstats.gradeinfo\\\" class=\\\"addon-mod_lesson-userstats\\\">\\r\\n                <ion-item>\\r\\n                    <ion-label class=\\\"ion-text-wrap\\\">\\r\\n                        <ion-grid class=\\\"ion-no-padding\\\">\\r\\n                            <ion-row>\\r\\n                                <ion-col>\\r\\n                                    <h3 class=\\\"item-heading\\\">{{ 'addon.mod_lesson.grade' | translate }}</h3>\\r\\n                                    <p>{{ 'core.percentagenumber' | translate:{$a: retake.userstats.grade} }}</p>\\r\\n                                </ion-col>\\r\\n\\r\\n                                <ion-col>\\r\\n                                    <h3 class=\\\"item-heading\\\">{{ 'addon.mod_lesson.rawgrade' | translate }}</h3>\\r\\n                                    <p>{{ retake.userstats.gradeinfo.earned }} / {{ retake.userstats.gradeinfo.total }}</p>\\r\\n                                </ion-col>\\r\\n                            </ion-row>\\r\\n                        </ion-grid>\\r\\n                    </ion-label>\\r\\n                </ion-item>\\r\\n                <ion-item class=\\\"ion-text-wrap\\\">\\r\\n                    <ion-label>\\r\\n                        <h3 class=\\\"item-heading\\\">{{ 'addon.mod_lesson.timetaken' | translate }}</h3>\\r\\n                        <p>{{ timeTakenReadable }}</p>\\r\\n                    </ion-label>\\r\\n                </ion-item>\\r\\n                <ion-item class=\\\"ion-text-wrap\\\">\\r\\n                    <ion-label>\\r\\n                        <h3 class=\\\"item-heading\\\">{{ 'addon.mod_lesson.completed' | translate }}</h3>\\r\\n                        <p>{{ retake.userstats.completed * 1000 | coreFormatDate }}</p>\\r\\n                    </ion-label>\\r\\n                </ion-item>\\r\\n            </ion-list>\\r\\n\\r\\n            <!-- Not completed, no stats. -->\\r\\n            <ion-item class=\\\"ion-text-wrap\\\" *ngIf=\\\"retake && (!retake.userstats || !retake.userstats.gradeinfo)\\\">\\r\\n                <ion-label>{{ 'addon.mod_lesson.notcompleted' | translate }}</ion-label>\\r\\n            </ion-item>\\r\\n\\r\\n            <!-- Pages. -->\\r\\n            <ng-container *ngIf=\\\"retake\\\">\\r\\n                <!-- The \\\"text-dimmed\\\" class does nothing, but the same goes for the \\\"dimmed\\\" class in Moodle. -->\\r\\n                <ion-card *ngFor=\\\"let page of retake.answerpages\\\" class=\\\"addon-mod_lesson-answerpage\\\"\\r\\n                    [ngClass]=\\\"{'text-dimmed': page.grayout}\\\">\\r\\n                    <ion-card-header class=\\\"ion-text-wrap\\\">\\r\\n                        <ion-card-title>{{page.qtype}}: {{page.title}}</ion-card-title>\\r\\n                    </ion-card-header>\\r\\n                    <ion-item class=\\\"ion-text-wrap\\\" lines=\\\"none\\\">\\r\\n                        <ion-label>\\r\\n                            <h3 class=\\\"item-heading\\\">{{ 'addon.mod_lesson.question' | translate }}</h3>\\r\\n                            <p>\\r\\n                                <core-format-text [component]=\\\"component\\\" [componentId]=\\\"lesson?.coursemodule\\\" [maxHeight]=\\\"50\\\"\\r\\n                                    [text]=\\\"page.contents\\\" contextLevel=\\\"module\\\" [contextInstanceId]=\\\"lesson?.coursemodule\\\"\\r\\n                                    [courseId]=\\\"courseId\\\">\\r\\n                                </core-format-text>\\r\\n                            </p>\\r\\n                        </ion-label>\\r\\n                    </ion-item>\\r\\n                    <ion-item class=\\\"ion-text-wrap\\\" lines=\\\"none\\\">\\r\\n                        <ion-label>\\r\\n                            <h3 class=\\\"item-heading\\\">{{ 'addon.mod_lesson.answer' | translate }}</h3>\\r\\n                        </ion-label>\\r\\n                    </ion-item>\\r\\n                    <ion-item class=\\\"ion-text-wrap\\\" lines=\\\"none\\\"\\r\\n                        *ngIf=\\\"!page.answerdata || !page.answerdata.answers || !page.answerdata.answers.length\\\">\\r\\n                        <ion-label>\\r\\n                            <p>{{ 'addon.mod_lesson.didnotanswerquestion' | translate }}</p>\\r\\n                        </ion-label>\\r\\n                    </ion-item>\\r\\n                    <div *ngIf=\\\"page.answerdata && page.answerdata.answers && page.answerdata.answers.length\\\"\\r\\n                        class=\\\"addon-mod_lesson-answer\\\">\\r\\n                        <ng-container *ngFor=\\\"let answer of page.answerdata.answers\\\">\\r\\n                            <ion-item lines=\\\"none\\\" *ngIf=\\\"page.isContent\\\">\\r\\n                                <ion-label class=\\\"ion-text-wrap\\\">\\r\\n                                    <ion-grid class=\\\"ion-no-padding\\\">\\r\\n                                        <!-- Content page, display a button and the content. -->\\r\\n                                        <ion-row>\\r\\n                                            <ion-col>\\r\\n                                                <ion-button expand=\\\"block\\\" class=\\\"ion-text-wrap\\\" color=\\\"light\\\" [disabled]=\\\"true\\\">\\r\\n                                                    {{ answer[0].buttonText }}\\r\\n                                                </ion-button>\\r\\n                                            </ion-col>\\r\\n                                            <ion-col>\\r\\n                                                <p [innerHTML]=\\\"answer[0].content\\\"></p>\\r\\n                                            </ion-col>\\r\\n                                        </ion-row>\\r\\n                                    </ion-grid>\\r\\n                                </ion-label>\\r\\n                            </ion-item>\\r\\n\\r\\n                            <ng-container *ngIf=\\\"page.isQuestion\\\">\\r\\n                                <!-- Question page, show the right input for the answer. -->\\r\\n\\r\\n                                <!-- Truefalse or matching. -->\\r\\n                                <ion-item class=\\\"ion-text-wrap\\\" *ngIf=\\\"answer[0].isCheckbox\\\"\\r\\n                                    [ngClass]=\\\"{'addon-mod_lesson-highlight': answer[0].highlight}\\\">\\r\\n                                    <ion-label>\\r\\n                                        <p>\\r\\n                                            <core-format-text [component]=\\\"component\\\" [componentId]=\\\"lesson?.coursemodule\\\"\\r\\n                                                [text]=\\\"answer[0].content\\\" contextLevel=\\\"module\\\"\\r\\n                                                [contextInstanceId]=\\\"lesson?.coursemodule\\\" [courseId]=\\\"courseId\\\">\\r\\n                                            </core-format-text>\\r\\n                                        </p>\\r\\n                                        <ion-badge *ngIf=\\\"answer[1]\\\" color=\\\"dark\\\">\\r\\n                                            <core-format-text [component]=\\\"component\\\" [componentId]=\\\"lesson?.coursemodule\\\"\\r\\n                                                [text]=\\\"answer[1]\\\" contextLevel=\\\"module\\\" [contextInstanceId]=\\\"lesson?.coursemodule\\\"\\r\\n                                                [courseId]=\\\"courseId\\\">\\r\\n                                            </core-format-text>\\r\\n                                        </ion-badge>\\r\\n                                    </ion-label>\\r\\n                                    <ion-checkbox [attr.name]=\\\"answer[0].name\\\" [ngModel]=\\\"answer[0].checked\\\" [disabled]=\\\"true\\\"\\r\\n                                        slot=\\\"end\\\">\\r\\n                                    </ion-checkbox>\\r\\n                                </ion-item>\\r\\n\\r\\n                                <!-- Short answer or numeric. -->\\r\\n                                <ion-item class=\\\"ion-text-wrap\\\" *ngIf=\\\"answer[0].isText\\\" lines=\\\"none\\\">\\r\\n                                    <ion-label>\\r\\n                                        <p>{{ answer[0].value }}</p>\\r\\n                                        <ion-badge *ngIf=\\\"answer[1]\\\" color=\\\"dark\\\">\\r\\n                                            <core-format-text [component]=\\\"component\\\" [componentId]=\\\"lesson?.coursemodule\\\"\\r\\n                                                [text]=\\\"answer[1]\\\" contextLevel=\\\"module\\\" [contextInstanceId]=\\\"lesson?.coursemodule\\\"\\r\\n                                                [courseId]=\\\"courseId\\\">\\r\\n                                            </core-format-text>\\r\\n                                        </ion-badge>\\r\\n                                    </ion-label>\\r\\n                                </ion-item>\\r\\n\\r\\n                                <!-- Matching. -->\\r\\n                                <ion-item lines=\\\"none\\\" *ngIf=\\\"answer[0].isSelect\\\">\\r\\n                                    <ion-label class=\\\"ion-text-wrap\\\">\\r\\n                                        <ion-grid class=\\\"ion-no-padding\\\">\\r\\n                                            <ion-row>\\r\\n                                                <ion-col>\\r\\n                                                    <p>\\r\\n                                                        <core-format-text [component]=\\\"component\\\" [componentId]=\\\"lesson?.coursemodule\\\"\\r\\n                                                            [text]=\\\" answer[0].content\\\" contextLevel=\\\"module\\\"\\r\\n                                                            [contextInstanceId]=\\\"lesson?.coursemodule\\\" [courseId]=\\\"courseId\\\">\\r\\n                                                        </core-format-text>\\r\\n                                                    </p>\\r\\n                                                </ion-col>\\r\\n                                                <ion-col>\\r\\n                                                    <p>{{answer[0].value}}</p>\\r\\n                                                    <ion-badge *ngIf=\\\"answer[1]\\\" color=\\\"dark\\\">\\r\\n                                                        <core-format-text [component]=\\\"component\\\" [componentId]=\\\"lesson?.coursemodule\\\"\\r\\n                                                            [text]=\\\"answer[1]\\\" contextLevel=\\\"module\\\"\\r\\n                                                            [contextInstanceId]=\\\"lesson?.coursemodule\\\" [courseId]=\\\"courseId\\\">\\r\\n                                                        </core-format-text>\\r\\n                                                    </ion-badge>\\r\\n                                                </ion-col>\\r\\n                                            </ion-row>\\r\\n                                        </ion-grid>\\r\\n                                    </ion-label>\\r\\n                                </ion-item>\\r\\n\\r\\n                                <!-- Essay or couldn't determine. -->\\r\\n                                <ion-item class=\\\"ion-text-wrap\\\" lines=\\\"none\\\"\\r\\n                                    *ngIf=\\\"!answer[0].isCheckbox && !answer[0].isText && !answer[0].isSelect\\\">\\r\\n                                    <ion-label>\\r\\n                                        <p>\\r\\n                                            <core-format-text [component]=\\\"component\\\" [componentId]=\\\"lesson?.coursemodule\\\"\\r\\n                                                [text]=\\\"answer[0]\\\" contextLevel=\\\"module\\\" [contextInstanceId]=\\\"lesson?.coursemodule\\\"\\r\\n                                                [courseId]=\\\"courseId\\\">\\r\\n                                            </core-format-text>\\r\\n                                        </p>\\r\\n                                        <ion-badge *ngIf=\\\"answer[1]\\\" color=\\\"dark\\\">\\r\\n                                            <core-format-text [component]=\\\"component\\\" [componentId]=\\\"lesson?.coursemodule\\\"\\r\\n                                                [text]=\\\"answer[1]\\\" contextLevel=\\\"module\\\" [contextInstanceId]=\\\"lesson?.coursemodule\\\"\\r\\n                                                [courseId]=\\\"courseId\\\">\\r\\n                                            </core-format-text>\\r\\n                                        </ion-badge>\\r\\n                                    </ion-label>\\r\\n                                </ion-item>\\r\\n                            </ng-container>\\r\\n\\r\\n                            <ion-item class=\\\"ion-text-wrap\\\" *ngIf=\\\"!page.isContent && !page.isQuestion\\\" lines=\\\"none\\\">\\r\\n                                <!-- Another page (end of branch, ...). -->\\r\\n                                <ion-label>\\r\\n                                    <p>\\r\\n                                        <core-format-text [component]=\\\"component\\\" [componentId]=\\\"lesson?.coursemodule\\\"\\r\\n                                            [text]=\\\"answer[0]\\\" contextLevel=\\\"module\\\" [contextInstanceId]=\\\"lesson?.coursemodule\\\"\\r\\n                                            [courseId]=\\\"courseId\\\">\\r\\n                                        </core-format-text>\\r\\n                                    </p>\\r\\n                                    <ion-badge *ngIf=\\\"answer[1]\\\" color=\\\"dark\\\">\\r\\n                                        <core-format-text [component]=\\\"component\\\" [componentId]=\\\"lesson?.coursemodule\\\"\\r\\n                                            [text]=\\\"answer[1]\\\" contextLevel=\\\"module\\\" [contextInstanceId]=\\\"lesson?.coursemodule\\\"\\r\\n                                            [courseId]=\\\"courseId\\\">\\r\\n                                        </core-format-text>\\r\\n                                    </ion-badge>\\r\\n                                </ion-label>\\r\\n                            </ion-item>\\r\\n                        </ng-container>\\r\\n\\r\\n                        <ion-item class=\\\"ion-text-wrap\\\" *ngIf=\\\"page.answerdata.response\\\" lines=\\\"none\\\">\\r\\n                            <ion-label>\\r\\n                                <h3 class=\\\"item-heading\\\">{{ 'addon.mod_lesson.response' | translate }}</h3>\\r\\n                                <p>\\r\\n                                    <core-format-text [component]=\\\"component\\\" [componentId]=\\\"lesson?.coursemodule\\\"\\r\\n                                        [text]=\\\"page.answerdata.response\\\" contextLevel=\\\"module\\\"\\r\\n                                        [contextInstanceId]=\\\"lesson?.coursemodule\\\" [courseId]=\\\"courseId\\\">\\r\\n                                    </core-format-text>\\r\\n                                </p>\\r\\n                            </ion-label>\\r\\n                        </ion-item>\\r\\n                        <ion-item class=\\\"ion-text-wrap\\\" *ngIf=\\\"page.answerdata.score\\\">\\r\\n                            <ion-label><p>{{page.answerdata.score}}</p></ion-label>\\r\\n                        </ion-item>\\r\\n                    </div>\\r\\n                </ion-card>\\r\\n            </ng-container>\\r\\n        </div>\\r\\n    </core-loading>\\r\\n</ion-content>\\r\\n\";","// (C) Copyright 2015 Moodle Pty Ltd.\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\n\r\nimport { CoreSharedModule } from '@/core/shared.module';\r\nimport { AddonModLessonUserRetakePage } from './user-retake.page';\r\n\r\nconst routes: Routes = [\r\n    {\r\n        path: '',\r\n        component: AddonModLessonUserRetakePage,\r\n    },\r\n];\r\n\r\n@NgModule({\r\n    imports: [\r\n        RouterModule.forChild(routes),\r\n        CoreSharedModule,\r\n    ],\r\n    declarations: [\r\n        AddonModLessonUserRetakePage,\r\n    ],\r\n    exports: [RouterModule],\r\n})\r\nexport class AddonModLessonUserRetakePageModule {}\r\n","// (C) Copyright 2015 Moodle Pty Ltd.\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { IonRefresher } from '@ionic/angular';\r\n\r\nimport { CoreError } from '@classes/errors/error';\r\nimport { CoreUser } from '@features/user/services/user';\r\nimport { CoreNavigator } from '@services/navigator';\r\nimport { CoreSites } from '@services/sites';\r\nimport { CoreDomUtils } from '@services/utils/dom';\r\nimport { CoreTextUtils } from '@services/utils/text';\r\nimport { CoreUtils } from '@services/utils/utils';\r\nimport { Translate } from '@singletons';\r\nimport {\r\n    AddonModLesson,\r\n    AddonModLessonAttemptsOverviewsAttemptWSData,\r\n    AddonModLessonAttemptsOverviewsStudentWSData,\r\n    AddonModLessonGetUserAttemptWSResponse,\r\n    AddonModLessonLessonWSData,\r\n    AddonModLessonProvider,\r\n    AddonModLessonUserAttemptAnswerData,\r\n    AddonModLessonUserAttemptAnswerPageWSData,\r\n} from '../../services/lesson';\r\nimport { AddonModLessonAnswerData, AddonModLessonHelper } from '../../services/lesson-helper';\r\nimport { CoreTimeUtils } from '@services/utils/time';\r\n\r\n/**\r\n * Page that displays a retake made by a certain user.\r\n */\r\n@Component({\r\n    selector: 'page-addon-mod-lesson-user-retake',\r\n    templateUrl: 'user-retake.html',\r\n    styleUrls: ['user-retake.scss'],\r\n})\r\nexport class AddonModLessonUserRetakePage implements OnInit {\r\n\r\n    component = AddonModLessonProvider.COMPONENT;\r\n    lesson?: AddonModLessonLessonWSData; // The lesson the retake belongs to.\r\n    courseId!: number; // Course ID the lesson belongs to.\r\n    selectedRetake?: number; // The retake to see.\r\n    student?: StudentData; // Data about the student and his retakes.\r\n    retake?: RetakeToDisplay; // Data about the retake.\r\n    loaded?: boolean; // Whether the data has been loaded.\r\n    timeTakenReadable?: string; // Time taken in a readable format.\r\n\r\n    protected cmId!: number; // The lesson ID the retake belongs to.\r\n    protected userId?: number; // User ID to see the retakes.\r\n    protected retakeNumber?: number; // Number of the initial retake to see.\r\n    protected previousSelectedRetake?: number; // To be able to detect the previous selected retake when it has changed.\r\n\r\n    /**\r\n     * Component being initialized.\r\n     */\r\n    ngOnInit(): void {\r\n        this.cmId = CoreNavigator.getRouteNumberParam('cmId')!;\r\n        this.courseId = CoreNavigator.getRouteNumberParam('courseId')!;\r\n        this.userId = CoreNavigator.getRouteNumberParam('userId') || CoreSites.getCurrentSiteUserId();\r\n        this.retakeNumber = CoreNavigator.getRouteNumberParam('retake');\r\n\r\n        // Fetch the data.\r\n        this.fetchData().finally(() => {\r\n            this.loaded = true;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Change the retake displayed.\r\n     *\r\n     * @param retakeNumber The new retake number.\r\n     */\r\n    async changeRetake(retakeNumber: number): Promise<void> {\r\n        this.loaded = false;\r\n\r\n        try {\r\n            await this.setRetake(retakeNumber);\r\n        } catch (error) {\r\n            this.selectedRetake = this.previousSelectedRetake;\r\n            CoreDomUtils.showErrorModal(CoreUtils.addDataNotDownloadedError(error, 'Error getting attempt.'));\r\n        } finally {\r\n            this.loaded = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Pull to refresh.\r\n     *\r\n     * @param refresher Refresher.\r\n     */\r\n    doRefresh(refresher: IonRefresher): void {\r\n        this.refreshData().finally(() => {\r\n            refresher?.complete();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Get lesson and retake data.\r\n     *\r\n     * @return Promise resolved when done.\r\n     */\r\n    protected async fetchData(): Promise<void> {\r\n        try {\r\n            this.lesson = await AddonModLesson.getLesson(this.courseId, this.cmId);\r\n\r\n            // Get the retakes overview for all participants.\r\n            const data = await AddonModLesson.getRetakesOverview(this.lesson.id, {\r\n                cmId: this.cmId,\r\n            });\r\n\r\n            // Search the student.\r\n            const student: StudentData | undefined = data?.students?.find(student => student.id == this.userId);\r\n            if (!student) {\r\n                // Student not found.\r\n                throw new CoreError(Translate.instant('addon.mod_lesson.cannotfinduser'));\r\n            }\r\n\r\n            if (!student.attempts.length) {\r\n                // No retakes.\r\n                throw new CoreError(Translate.instant('addon.mod_lesson.cannotfindattempt'));\r\n            }\r\n\r\n            student.bestgrade = CoreTextUtils.roundToDecimals(student.bestgrade, 2);\r\n            student.attempts.forEach((retake) => {\r\n                if (!this.selectedRetake && this.retakeNumber == retake.try) {\r\n                    // The retake specified as parameter exists. Use it.\r\n                    this.selectedRetake = this.retakeNumber;\r\n                }\r\n\r\n                retake.label = AddonModLessonHelper.getRetakeLabel(retake);\r\n            });\r\n\r\n            if (!this.selectedRetake) {\r\n                // Retake number not specified or not valid, use the last retake.\r\n                this.selectedRetake = student.attempts[student.attempts.length - 1].try;\r\n            }\r\n\r\n            // Get the profile image of the user.\r\n            const user = await CoreUtils.ignoreErrors(CoreUser.getProfile(student.id, this.courseId, true));\r\n\r\n            this.student = student;\r\n            this.student.profileimageurl = user?.profileimageurl;\r\n\r\n            await this.setRetake(this.selectedRetake);\r\n        } catch (error) {\r\n            CoreDomUtils.showErrorModalDefault(error, 'Error getting data.', true);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Refreshes data.\r\n     *\r\n     * @return Promise resolved when done.\r\n     */\r\n    protected async refreshData(): Promise<void> {\r\n        const promises: Promise<void>[] = [];\r\n\r\n        promises.push(AddonModLesson.invalidateLessonData(this.courseId));\r\n        if (this.lesson) {\r\n            promises.push(AddonModLesson.invalidateRetakesOverview(this.lesson.id));\r\n            promises.push(AddonModLesson.invalidateUserRetakesForUser(this.lesson.id, this.userId));\r\n        }\r\n\r\n        await CoreUtils.ignoreErrors(Promise.all(promises));\r\n\r\n        await this.fetchData();\r\n    }\r\n\r\n    /**\r\n     * Set the retake to view and load its data.\r\n     *\r\n     * @param retakeNumber Retake number to set.\r\n     * @return Promise resolved when done.\r\n     */\r\n    protected async setRetake(retakeNumber: number): Promise<void> {\r\n        this.selectedRetake = retakeNumber;\r\n\r\n        const retakeData = await AddonModLesson.getUserRetake(this.lesson!.id, retakeNumber, {\r\n            cmId: this.cmId,\r\n            userId: this.userId,\r\n        });\r\n\r\n        this.retake = this.formatRetake(retakeData);\r\n        this.previousSelectedRetake = this.selectedRetake;\r\n    }\r\n\r\n    /**\r\n     * Format retake data, adding some calculated data.\r\n     *\r\n     * @param data Retake data.\r\n     * @return Formatted data.\r\n     */\r\n    protected formatRetake(retakeData: AddonModLessonGetUserAttemptWSResponse): RetakeToDisplay {\r\n        const formattedData = <RetakeToDisplay> retakeData;\r\n\r\n        if (formattedData.userstats.gradeinfo) {\r\n            // Completed.\r\n            formattedData.userstats.grade = CoreTextUtils.roundToDecimals(formattedData.userstats.grade, 2);\r\n            this.timeTakenReadable = CoreTimeUtils.formatTime(formattedData.userstats.timetotake);\r\n        }\r\n\r\n        // Format pages data.\r\n        formattedData.answerpages.forEach((page) => {\r\n            if (AddonModLesson.answerPageIsContent(page)) {\r\n                page.isContent = true;\r\n\r\n                if (page.answerdata?.answers) {\r\n                    page.answerdata.answers.forEach((answer) => {\r\n                        // Content pages only have 1 valid field in the answer array.\r\n                        answer[0] = AddonModLessonHelper.getContentPageAnswerDataFromHtml(answer[0]);\r\n                    });\r\n                }\r\n            } else if (AddonModLesson.answerPageIsQuestion(page)) {\r\n                page.isQuestion = true;\r\n\r\n                if (page.answerdata?.answers) {\r\n                    page.answerdata.answers.forEach((answer) => {\r\n                        // Only the first field of the answer array requires to be parsed.\r\n                        answer[0] = AddonModLessonHelper.getQuestionPageAnswerDataFromHtml(answer[0]);\r\n                    });\r\n                }\r\n            }\r\n        });\r\n\r\n        return formattedData;\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * Student data with some calculated data.\r\n */\r\ntype StudentData = Omit<AddonModLessonAttemptsOverviewsStudentWSData, 'attempts'> & {\r\n    profileimageurl?: string;\r\n    attempts: AttemptWithLabel[];\r\n};\r\n\r\n/**\r\n * Student attempt with a calculated label.\r\n */\r\ntype AttemptWithLabel = AddonModLessonAttemptsOverviewsAttemptWSData & {\r\n    label?: string;\r\n};\r\n/**\r\n * Retake with calculated data.\r\n */\r\ntype RetakeToDisplay = Omit<AddonModLessonGetUserAttemptWSResponse, 'answerpages'> & {\r\n    answerpages: AnswerPage[];\r\n};\r\n\r\n/**\r\n * Answer page with calculated data.\r\n */\r\ntype AnswerPage = Omit<AddonModLessonUserAttemptAnswerPageWSData, 'answerdata'> & {\r\n    isContent?: boolean;\r\n    isQuestion?: boolean;\r\n    answerdata?: AnswerData;\r\n};\r\n\r\n/**\r\n * Answer data with calculated data.\r\n */\r\ntype AnswerData = Omit<AddonModLessonUserAttemptAnswerData, 'answers'> & {\r\n    answers?: (string[] | AddonModLessonAnswerData)[]; // User answers.\r\n};\r\n","export default \":host .button-disabled {\\n  opacity: 0.4;\\n}\\n:host .addon-mod_lesson-highlight {\\n  --background: var(--blue-light);\\n}\\n:host .addon-mod_lesson-highlight ion-label, :host .addon-mod_lesson-highlight ion-label p {\\n  color: var(--blue-dark);\\n}\\n:host .item-interactive-disabled ion-label {\\n  opacity: 0.5;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hZGRvbnMvbW9kL2xlc3Nvbi9wYWdlcy91c2VyLXJldGFrZS91c2VyLXJldGFrZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNJO0VBQ0ksWUFBQTtBQUFSO0FBR0k7RUFDSSwrQkFBQTtBQURSO0FBR1E7RUFDSSx1QkFBQTtBQURaO0FBS0k7RUFDSSxZQUFBO0FBSFIiLCJmaWxlIjoic3JjL2FkZG9ucy9tb2QvbGVzc29uL3BhZ2VzL3VzZXItcmV0YWtlL3VzZXItcmV0YWtlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyI6aG9zdCB7XHJcbiAgICAuYnV0dG9uLWRpc2FibGVkIHtcclxuICAgICAgICBvcGFjaXR5OiAwLjQ7XHJcbiAgICB9XHJcblxyXG4gICAgLmFkZG9uLW1vZF9sZXNzb24taGlnaGxpZ2h0IHtcclxuICAgICAgICAtLWJhY2tncm91bmQ6IHZhcigtLWJsdWUtbGlnaHQpO1xyXG5cclxuICAgICAgICBpb24tbGFiZWwsIGlvbi1sYWJlbCBwIHtcclxuICAgICAgICAgICAgY29sb3I6IHZhcigtLWJsdWUtZGFyayk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC5pdGVtLWludGVyYWN0aXZlLWRpc2FibGVkIGlvbi1sYWJlbCB7XHJcbiAgICAgICAgb3BhY2l0eTogMC41O1xyXG4gICAgfVxyXG59XHJcbiJdfQ== */\";"],"sourceRoot":"webpack:///"}