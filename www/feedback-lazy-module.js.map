{"version":3,"sources":["./src/addons/mod/feedback/pages/index/index.html","./src/addons/mod/feedback/pages/respondents/respondents.html","./src/addons/mod/feedback/feedback-lazy.module.ts","./src/addons/mod/feedback/pages/index/index.ts","./src/addons/mod/feedback/pages/respondents/respondents.ts"],"names":[],"mappings":"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","file":"feedback-lazy-module.js","sourcesContent":["export default \"<ion-header>\\r\\n    <ion-toolbar>\\r\\n        <ion-buttons slot=\\\"start\\\">\\r\\n            <ion-back-button [text]=\\\"'core.back' | translate\\\"></ion-back-button>\\r\\n        </ion-buttons>\\r\\n        <h1>\\r\\n            <core-format-text [text]=\\\"title\\\" contextLevel=\\\"module\\\" [contextInstanceId]=\\\"module?.id\\\" [courseId]=\\\"courseId\\\">\\r\\n            </core-format-text>\\r\\n        </h1>\\r\\n        <ion-buttons slot=\\\"end\\\">\\r\\n            <!-- The buttons defined by the component will be added in here. -->\\r\\n        </ion-buttons>\\r\\n    </ion-toolbar>\\r\\n</ion-header>\\r\\n<ion-content>\\r\\n    <ion-refresher slot=\\\"fixed\\\" [disabled]=\\\"!activityComponent?.loaded\\\" (ionRefresh)=\\\"activityComponent?.doRefresh($event.target)\\\">\\r\\n        <ion-refresher-content pullingText=\\\"{{ 'core.pulltorefresh' | translate }}\\\"></ion-refresher-content>\\r\\n    </ion-refresher>\\r\\n\\r\\n    <addon-mod-feedback-index [module]=\\\"module\\\" [courseId]=\\\"courseId\\\" [group]=\\\"selectedGroup\\\" [tab]=\\\"selectedTab\\\"\\r\\n        (dataRetrieved)=\\\"updateData($event)\\\"></addon-mod-feedback-index>\\r\\n</ion-content>\\r\\n\";","export default \"<ion-header>\\r\\n    <ion-toolbar>\\r\\n        <ion-buttons slot=\\\"start\\\">\\r\\n            <ion-back-button [text]=\\\"'core.back' | translate\\\"></ion-back-button>\\r\\n        </ion-buttons>\\r\\n        <h1>{{ 'addon.mod_feedback.responses' |translate }}</h1>\\r\\n    </ion-toolbar>\\r\\n</ion-header>\\r\\n<ion-content>\\r\\n    <core-split-view>\\r\\n        <ion-refresher slot=\\\"fixed\\\" [disabled]=\\\"!loaded\\\" (ionRefresh)=\\\"refreshFeedback($event.target)\\\">\\r\\n            <ion-refresher-content pullingText=\\\"{{ 'core.pulltorefresh' | translate }}\\\"></ion-refresher-content>\\r\\n        </ion-refresher>\\r\\n        <core-loading [hideUntil]=\\\"loaded\\\">\\r\\n            <ion-list class=\\\"ion-no-margin\\\">\\r\\n                <ion-item class=\\\"ion-text-wrap\\\" *ngIf=\\\"groupInfo && (groupInfo.separateGroups || groupInfo.visibleGroups)\\\">\\r\\n                    <ion-label id=\\\"addon-feedback-groupslabel\\\">\\r\\n                        <ng-container *ngIf=\\\"groupInfo.separateGroups\\\">{{'core.groupsseparate' | translate }}</ng-container>\\r\\n                        <ng-container *ngIf=\\\"groupInfo.visibleGroups\\\">{{'core.groupsvisible' | translate }}</ng-container>\\r\\n                    </ion-label>\\r\\n                    <ion-select [(ngModel)]=\\\"selectedGroup\\\" (ionChange)=\\\"loadAttempts(selectedGroup)\\\"\\r\\n                        aria-labelledby=\\\"addon-feedback-groupslabel\\\" interface=\\\"action-sheet\\\"\\r\\n                        [interfaceOptions]=\\\"{header: 'core.group' | translate}\\\">\\r\\n                        <ion-select-option *ngFor=\\\"let groupOpt of groupInfo.groups\\\" [value]=\\\"groupOpt.id\\\">\\r\\n                            {{groupOpt.name}}\\r\\n                        </ion-select-option>\\r\\n                    </ion-select>\\r\\n                </ion-item>\\r\\n\\r\\n                <ng-container *ngIf=\\\"responses.responses.total > 0\\\">\\r\\n                    <ion-item-divider>\\r\\n                        <ion-label>\\r\\n                            <h2>{{ 'addon.mod_feedback.non_anonymous_entries' | translate : {$a: responses.responses.total } }}</h2>\\r\\n                        </ion-label>\\r\\n                    </ion-item-divider>\\r\\n                    <ion-item *ngFor=\\\"let attempt of responses.responses.attempts\\\" class=\\\"ion-text-wrap\\\" button detail=\\\"true\\\"\\r\\n                        (click)=\\\"responses.select(attempt)\\\" [attr.aria-current]=\\\"responses.getItemAriaCurrent(attempt)\\\">\\r\\n                        <core-user-avatar [user]=\\\"attempt\\\" slot=\\\"start\\\"></core-user-avatar>\\r\\n                        <ion-label>\\r\\n                            <p class=\\\"item-heading\\\">{{ attempt.fullname }}</p>\\r\\n                            <p *ngIf=\\\"attempt.timemodified\\\">{{attempt.timemodified * 1000 | coreFormatDate }}</p>\\r\\n                        </ion-label>\\r\\n                    </ion-item>\\r\\n\\r\\n                    <!-- Button and spinner to show more attempts. -->\\r\\n                    <ion-button *ngIf=\\\"responses.responses.canLoadMore && !loadingMore\\\" class=\\\"ion-margin\\\" expand=\\\"block\\\"\\r\\n                        (click)=\\\"loadAttempts()\\\">\\r\\n                        {{ 'core.loadmore' | translate }}\\r\\n                    </ion-button>\\r\\n                    <ion-item *ngIf=\\\"responses.responses.canLoadMore && loadingMore\\\" class=\\\"ion-text-center\\\">\\r\\n                        <ion-label><ion-spinner [attr.aria-label]=\\\"'core.loading' | translate\\\"></ion-spinner></ion-label>\\r\\n                    </ion-item>\\r\\n                </ng-container>\\r\\n\\r\\n                <ng-container *ngIf=\\\"responses.anonResponses.total > 0\\\">\\r\\n                    <ion-item-divider>\\r\\n                        <ion-label>\\r\\n                            <h2>{{ 'addon.mod_feedback.anonymous_entries' |translate : {$a: responses.anonResponses.total } }}</h2>\\r\\n                        </ion-label>\\r\\n                    </ion-item-divider>\\r\\n                    <ion-item *ngFor=\\\"let attempt of responses.anonResponses.attempts\\\" class=\\\"ion-text-wrap\\\" button detail=\\\"true\\\"\\r\\n                        (click)=\\\"responses.select(attempt)\\\" [attr.aria-current]=\\\"responses.getItemAriaCurrent(attempt)\\\">\\r\\n                        <ion-label>\\r\\n                            <h2>{{ 'addon.mod_feedback.response_nr' |translate }}: {{attempt.number}}</h2>\\r\\n                        </ion-label>\\r\\n                    </ion-item>\\r\\n\\r\\n                    <!-- Button and spinner to show more attempts. -->\\r\\n                    <ion-button *ngIf=\\\"responses.anonResponses.canLoadMore && !loadingMore\\\" class=\\\"ion-margin\\\" expand=\\\"block\\\"\\r\\n                        (click)=\\\"loadAttempts()\\\">\\r\\n                        {{ 'core.loadmore' | translate }}\\r\\n                    </ion-button>\\r\\n                    <ion-item *ngIf=\\\"responses.anonResponses.canLoadMore && loadingMore\\\" class=\\\"ion-text-center\\\">\\r\\n                        <ion-label><ion-spinner [attr.aria-label]=\\\"'core.loading' | translate\\\"></ion-spinner></ion-label>\\r\\n                    </ion-item>\\r\\n                </ng-container>\\r\\n            </ion-list>\\r\\n        </core-loading>\\r\\n    </core-split-view>\\r\\n</ion-content>\\r\\n\";","// (C) Copyright 2015 Moodle Pty Ltd.\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { CoreSharedModule } from '@/core/shared.module';\r\nimport { AddonModFeedbackComponentsModule } from './components/components.module';\r\nimport { AddonModFeedbackIndexPage } from './pages/index/index';\r\nimport { AddonModFeedbackRespondentsPage } from './pages/respondents/respondents';\r\nimport { conditionalRoutes } from '@/app/app-routing.module';\r\nimport { CoreScreen } from '@services/screen';\r\n\r\nconst commonRoutes: Routes = [\r\n    {\r\n        path: ':courseId/:cmId',\r\n        component: AddonModFeedbackIndexPage,\r\n    },\r\n    {\r\n        path: ':courseId/:cmId/form',\r\n        loadChildren: () => import('./pages/form/form.module').then(m => m.AddonModFeedbackFormPageModule),\r\n    },\r\n    {\r\n        path: ':courseId/:cmId/nonrespondents',\r\n        loadChildren: () => import('./pages/nonrespondents/nonrespondents.module')\r\n            .then(m => m.AddonModFeedbackNonRespondentsPageModule),\r\n    },\r\n];\r\n\r\nconst mobileRoutes: Routes = [\r\n    ...commonRoutes,\r\n    {\r\n        path: ':courseId/:cmId/respondents',\r\n        component: AddonModFeedbackRespondentsPage,\r\n    },\r\n    {\r\n        path: ':courseId/:cmId/respondents/attempt/:attemptId',\r\n        loadChildren: () => import('./pages/attempt/attempt.module').then(m => m.AddonModFeedbackAttemptPageModule),\r\n    },\r\n];\r\n\r\nconst tabletRoutes: Routes = [\r\n    ...commonRoutes,\r\n    {\r\n        path: ':courseId/:cmId/respondents',\r\n        component: AddonModFeedbackRespondentsPage,\r\n        children: [\r\n            {\r\n                path: 'attempt/:attemptId',\r\n                loadChildren: () => import('./pages/attempt/attempt.module').then(m => m.AddonModFeedbackAttemptPageModule),\r\n            },\r\n        ],\r\n    },\r\n];\r\n\r\nconst routes: Routes = [\r\n    ...conditionalRoutes(mobileRoutes, () => CoreScreen.isMobile),\r\n    ...conditionalRoutes(tabletRoutes, () => CoreScreen.isTablet),\r\n];\r\n\r\n@NgModule({\r\n    imports: [\r\n        RouterModule.forChild(routes),\r\n        CoreSharedModule,\r\n        AddonModFeedbackComponentsModule,\r\n    ],\r\n    declarations: [\r\n        AddonModFeedbackIndexPage,\r\n        AddonModFeedbackRespondentsPage,\r\n    ],\r\n})\r\nexport class AddonModFeedbackLazyModule {}\r\n","// (C) Copyright 2015 Moodle Pty Ltd.\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { CoreCourseModuleMainActivityPage } from '@features/course/classes/main-activity-page';\r\nimport { CoreNavigator } from '@services/navigator';\r\nimport { AddonModFeedbackIndexComponent } from '../../components/index/index';\r\n\r\n/**\r\n * Page that displays a feedback.\r\n */\r\n@Component({\r\n    selector: 'page-addon-mod-feedback-index',\r\n    templateUrl: 'index.html',\r\n})\r\nexport class AddonModFeedbackIndexPage extends CoreCourseModuleMainActivityPage<AddonModFeedbackIndexComponent> implements OnInit {\r\n\r\n    @ViewChild(AddonModFeedbackIndexComponent) activityComponent?: AddonModFeedbackIndexComponent;\r\n\r\n    selectedTab?: string;\r\n    selectedGroup?: number;\r\n\r\n    /**\r\n     * Component being initialized.\r\n     */\r\n    ngOnInit(): void {\r\n        super.ngOnInit();\r\n        this.selectedTab = CoreNavigator.getRouteParam('tab');\r\n        this.selectedGroup = CoreNavigator.getRouteNumberParam('group');\r\n    }\r\n\r\n}\r\n","// (C) Copyright 2015 Moodle Pty Ltd.\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { AfterViewInit, Component, ViewChild } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { CorePageItemsListManager } from '@classes/page-items-list-manager';\r\nimport { CoreSplitViewComponent } from '@components/split-view/split-view';\r\nimport { IonRefresher } from '@ionic/angular';\r\nimport { CoreGroupInfo, CoreGroups } from '@services/groups';\r\nimport { CoreNavigator } from '@services/navigator';\r\nimport { CoreDomUtils } from '@services/utils/dom';\r\nimport { CoreUtils } from '@services/utils/utils';\r\nimport {\r\n    AddonModFeedback,\r\n    AddonModFeedbackWSAnonAttempt,\r\n    AddonModFeedbackWSAttempt,\r\n    AddonModFeedbackWSFeedback,\r\n} from '../../services/feedback';\r\nimport { AddonModFeedbackHelper, AddonModFeedbackResponsesAnalysis } from '../../services/feedback-helper';\r\n\r\n/**\r\n * Page that displays feedback respondents.\r\n */\r\n@Component({\r\n    selector: 'page-addon-mod-feedback-respondents',\r\n    templateUrl: 'respondents.html',\r\n})\r\nexport class AddonModFeedbackRespondentsPage implements AfterViewInit {\r\n\r\n    @ViewChild(CoreSplitViewComponent) splitView!: CoreSplitViewComponent;\r\n\r\n    protected cmId!: number;\r\n    protected courseId!: number;\r\n    protected page = 0;\r\n    protected feedback?: AddonModFeedbackWSFeedback;\r\n\r\n    responses: AddonModFeedbackResponsesManager;\r\n    selectedGroup!: number;\r\n    groupInfo?: CoreGroupInfo;\r\n    loaded = false;\r\n    loadingMore = false;\r\n\r\n    constructor(\r\n        route: ActivatedRoute,\r\n    ) {\r\n        this.responses = new AddonModFeedbackResponsesManager(\r\n            route.component,\r\n        );\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    async ngAfterViewInit(): Promise<void> {\r\n        this.cmId = CoreNavigator.getRouteNumberParam('cmId')!;\r\n        this.courseId = CoreNavigator.getRouteNumberParam('courseId')!;\r\n        this.selectedGroup = CoreNavigator.getRouteNumberParam('group') || 0;\r\n\r\n        await this.fetchData();\r\n\r\n        this.responses.start(this.splitView);\r\n    }\r\n\r\n    /**\r\n     * Fetch all the data required for the view.\r\n     *\r\n     * @param refresh Empty events array first.\r\n     * @return Promise resolved when done.\r\n     */\r\n    async fetchData(refresh: boolean = false): Promise<void> {\r\n        this.page = 0;\r\n        this.responses.resetItems();\r\n\r\n        try {\r\n            this.feedback = await AddonModFeedback.getFeedback(this.courseId, this.cmId);\r\n\r\n            this.groupInfo = await CoreGroups.getActivityGroupInfo(this.cmId);\r\n\r\n            this.selectedGroup = CoreGroups.validateGroupId(this.selectedGroup, this.groupInfo);\r\n\r\n            await this.loadGroupAttempts(this.selectedGroup);\r\n        } catch (error) {\r\n            CoreDomUtils.showErrorModalDefault(error, 'core.course.errorgetmodule', true);\r\n\r\n            if (!refresh) {\r\n                // Some call failed on first fetch, go back.\r\n                CoreNavigator.back();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Load Group attempts.\r\n     *\r\n     * @param groupId If defined it will change group if not, it will load more attempts for the same group.\r\n     * @return Resolved with the attempts loaded.\r\n     */\r\n    protected async loadGroupAttempts(groupId?: number): Promise<void> {\r\n        if (typeof groupId == 'undefined') {\r\n            this.page++;\r\n            this.loadingMore = true;\r\n        } else {\r\n            this.selectedGroup = groupId;\r\n            this.page = 0;\r\n            this.responses.resetItems();\r\n        }\r\n\r\n        try {\r\n            const responses = await AddonModFeedbackHelper.getResponsesAnalysis(this.feedback!.id, {\r\n                groupId: this.selectedGroup,\r\n                page: this.page,\r\n                cmId: this.cmId,\r\n            });\r\n\r\n            this.responses.setResponses(responses);\r\n        } finally {\r\n            this.loadingMore = false;\r\n            this.loaded = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Change selected group or load more attempts.\r\n     *\r\n     * @param groupId Group ID selected. If not defined, it will load more attempts.\r\n     */\r\n    async loadAttempts(groupId?: number): Promise<void> {\r\n        try {\r\n            await this.loadGroupAttempts(groupId);\r\n        } catch (error) {\r\n            CoreDomUtils.showErrorModalDefault(error, 'core.course.errorgetmodule', true);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Refresh the attempts.\r\n     *\r\n     * @param refresher Refresher.\r\n     */\r\n    async refreshFeedback(refresher: IonRefresher): Promise<void> {\r\n        const promises: Promise<void>[] = [];\r\n\r\n        promises.push(CoreGroups.invalidateActivityGroupInfo(this.cmId));\r\n        if (this.feedback) {\r\n            promises.push(AddonModFeedback.invalidateResponsesAnalysisData(this.feedback.id));\r\n        }\r\n\r\n        try {\r\n            await CoreUtils.ignoreErrors(Promise.all(promises));\r\n\r\n            await this.fetchData(true);\r\n        } finally {\r\n            refresher.complete();\r\n        }\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * Type of items that can be held by the entries manager.\r\n */\r\ntype EntryItem = AddonModFeedbackWSAttempt | AddonModFeedbackWSAnonAttempt;\r\n\r\n/**\r\n * Entries manager.\r\n */\r\nclass AddonModFeedbackResponsesManager extends CorePageItemsListManager<EntryItem> {\r\n\r\n    responses: AddonModFeedbackResponses = {\r\n        attempts: [],\r\n        total: 0,\r\n        canLoadMore: false,\r\n    };\r\n\r\n    anonResponses: AddonModFeedbackAnonResponses = {\r\n        attempts: [],\r\n        total: 0,\r\n        canLoadMore: false,\r\n    };\r\n\r\n    constructor(pageComponent: unknown) {\r\n        super(pageComponent);\r\n    }\r\n\r\n    /**\r\n     * Update responses.\r\n     *\r\n     * @param responses Responses.\r\n     */\r\n    setResponses(responses: AddonModFeedbackResponsesAnalysis): void {\r\n        this.responses.total = responses.totalattempts;\r\n        this.anonResponses.total = responses.totalanonattempts;\r\n\r\n        if (this.anonResponses.attempts.length < responses.totalanonattempts) {\r\n            this.anonResponses.attempts = this.anonResponses.attempts.concat(responses.anonattempts);\r\n        }\r\n        if (this.responses.attempts.length < responses.totalattempts) {\r\n            this.responses.attempts = this.responses.attempts.concat(responses.attempts);\r\n        }\r\n\r\n        this.anonResponses.canLoadMore = this.anonResponses.attempts.length < responses.totalanonattempts;\r\n        this.responses.canLoadMore = this.responses.attempts.length < responses.totalattempts;\r\n\r\n        this.setItems((<EntryItem[]> this.responses.attempts).concat(this.anonResponses.attempts));\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    resetItems(): void {\r\n        super.resetItems();\r\n        this.responses.total = 0;\r\n        this.responses.attempts = [];\r\n        this.anonResponses.total = 0;\r\n        this.anonResponses.attempts = [];\r\n    }\r\n\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    protected getItemPath(entry: EntryItem): string {\r\n        return `attempt/${entry.id}`;\r\n    }\r\n\r\n}\r\n\r\ntype AddonModFeedbackResponses = {\r\n    attempts: AddonModFeedbackWSAttempt[];\r\n    total: number;\r\n    canLoadMore: boolean;\r\n};\r\n\r\ntype AddonModFeedbackAnonResponses = {\r\n    attempts: AddonModFeedbackWSAnonAttempt[];\r\n    total: number;\r\n    canLoadMore: boolean;\r\n};\r\n"],"sourceRoot":"webpack:///"}