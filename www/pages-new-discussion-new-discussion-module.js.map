{"version":3,"sources":["./src/addons/mod/forum/pages/new-discussion/new-discussion.html","./src/addons/mod/forum/pages/new-discussion/new-discussion.module.ts","./src/addons/mod/forum/pages/new-discussion/new-discussion.page.ts"],"names":[],"mappings":"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","file":"pages-new-discussion-new-discussion-module.js","sourcesContent":["export default \"<ion-header>\\r\\n    <ion-toolbar>\\r\\n        <ion-buttons slot=\\\"start\\\">\\r\\n            <ion-back-button [text]=\\\"'core.back' | translate\\\"></ion-back-button>\\r\\n        </ion-buttons>\\r\\n        <h1>{{ 'addon.mod_forum.addanewdiscussion' | translate }}</h1>\\r\\n        <ion-buttons slot=\\\"end\\\">\\r\\n            <!-- The context menu will be added in here. -->\\r\\n        </ion-buttons>\\r\\n    </ion-toolbar>\\r\\n</ion-header>\\r\\n<ion-content>\\r\\n    <ion-refresher slot=\\\"fixed\\\" [disabled]=\\\"!groupsLoaded\\\" (ionRefresh)=\\\"refreshGroups($event.target)\\\">\\r\\n        <ion-refresher-content pullingText=\\\"{{ 'core.pulltorefresh' | translate }}\\\"></ion-refresher-content>\\r\\n    </ion-refresher>\\r\\n\\r\\n    <core-loading [hideUntil]=\\\"groupsLoaded\\\">\\r\\n        <form *ngIf=\\\"showForm\\\" #newDiscFormEl>\\r\\n            <ion-item>\\r\\n                <ion-label position=\\\"stacked\\\">{{ 'addon.mod_forum.subject' | translate }}</ion-label>\\r\\n                <ion-input\\r\\n                    [(ngModel)]=\\\"newDiscussion.subject\\\"\\r\\n                    type=\\\"text\\\" [placeholder]=\\\"'addon.mod_forum.subject' | translate\\\" name=\\\"subject\\\">\\r\\n                </ion-input>\\r\\n            </ion-item>\\r\\n            <ion-item>\\r\\n                <ion-label position=\\\"stacked\\\">{{ 'addon.mod_forum.message' | translate }}</ion-label>\\r\\n                <core-rich-text-editor name=\\\"addon_mod_forum_new_discussion\\\" contextLevel=\\\"module\\\" elementId=\\\"message\\\"\\r\\n                    [control]=\\\"messageControl\\\" [placeholder]=\\\"'addon.mod_forum.message' | translate\\\" [component]=\\\"component\\\"\\r\\n                    [componentId]=\\\"forum.cmid\\\" [autoSave]=\\\"true\\\" [contextInstanceId]=\\\"forum.cmid\\\"\\r\\n                    (contentChanged)=\\\"onMessageChange($event)\\\">\\r\\n                </core-rich-text-editor>\\r\\n            </ion-item>\\r\\n            <ion-item\\r\\n                button\\r\\n                class=\\\"divider ion-text-wrap\\\"\\r\\n                (click)=\\\"toggleAdvanced()\\\"\\r\\n                detail=\\\"false\\\"\\r\\n                [attr.aria-expanded]=\\\"advanced\\\"\\r\\n                [attr.aria-label]=\\\"(advanced ? 'core.hideadvanced' : 'core.showadvanced') | translate\\\"\\r\\n                role=\\\"heading\\\"\\r\\n                aria-controls=\\\"addon-mod-forum-new-discussion-advanced\\\"\\r\\n            >\\r\\n                <ion-icon *ngIf=\\\"!advanced\\\" name=\\\"fas-caret-right\\\" flip-rtl slot=\\\"start\\\" aria-hidden=\\\"true\\\"></ion-icon>\\r\\n                <ion-icon *ngIf=\\\"advanced\\\" name=\\\"fas-caret-down\\\" slot=\\\"start\\\" aria-hidden=\\\"true\\\"></ion-icon>\\r\\n                <ion-label><h2>{{ 'addon.mod_forum.advanced' | translate }}</h2></ion-label>\\r\\n            </ion-item>\\r\\n            <div *ngIf=\\\"advanced\\\" id=\\\"addon-mod-forum-new-discussion-advanced\\\">\\r\\n                <ion-item *ngIf=\\\"showGroups && groupIds.length > 1 && accessInfo.cancanposttomygroups\\\">\\r\\n                    <ion-label>{{ 'addon.mod_forum.posttomygroups' | translate }}</ion-label>\\r\\n                    <ion-toggle [(ngModel)]=\\\"newDiscussion.postToAllGroups\\\" name=\\\"postallgroups\\\"></ion-toggle>\\r\\n                </ion-item>\\r\\n                <ion-item *ngIf=\\\"showGroups\\\">\\r\\n                    <ion-label id=\\\"addon-mod-forum-groupslabel\\\">{{ 'addon.mod_forum.group' | translate }}</ion-label>\\r\\n                    <ion-select [(ngModel)]=\\\"newDiscussion.groupId\\\" [disabled]=\\\"newDiscussion.postToAllGroups\\\"\\r\\n                        aria-labelledby=\\\"addon-mod-forum-groupslabel\\\" interface=\\\"action-sheet\\\" name=\\\"groupid\\\"\\r\\n                        [interfaceOptions]=\\\"{header: 'addon.mod_forum.group' | translate}\\\">\\r\\n                        <ion-select-option *ngFor=\\\"let group of groups\\\" [value]=\\\"group.id\\\">{{ group.name }}</ion-select-option>\\r\\n                    </ion-select>\\r\\n                </ion-item>\\r\\n                <ion-item>\\r\\n                    <ion-label>{{ 'addon.mod_forum.discussionsubscription' | translate }}</ion-label>\\r\\n                    <ion-toggle [(ngModel)]=\\\"newDiscussion.subscribe\\\" name=\\\"subscribe\\\"></ion-toggle>\\r\\n                </ion-item>\\r\\n                <ion-item *ngIf=\\\"canPin\\\">\\r\\n                    <ion-label>{{ 'addon.mod_forum.discussionpinned' | translate }}</ion-label>\\r\\n                    <ion-toggle [(ngModel)]=\\\"newDiscussion.pin\\\" name=\\\"pin\\\"></ion-toggle>\\r\\n                </ion-item>\\r\\n                <core-attachments *ngIf=\\\"canCreateAttachments && forum && forum.maxattachments > 0\\\"\\r\\n                    [files]=\\\"newDiscussion.files\\\" [maxSize]=\\\"forum.maxbytes\\\" [maxSubmissions]=\\\"forum.maxattachments\\\"\\r\\n                    [component]=\\\"component\\\" [componentId]=\\\"forum.cmid\\\" [allowOffline]=\\\"true\\\" [courseId]=\\\"courseId\\\">\\r\\n                </core-attachments>\\r\\n            </div>\\r\\n            <ion-item>\\r\\n                <ion-label>\\r\\n                    <ion-row>\\r\\n                        <ion-col>\\r\\n                            <ion-button\\r\\n                                expand=\\\"block\\\" [disabled]=\\\"newDiscussion.subject == '' || newDiscussion.message == null\\\"\\r\\n                                (click)=\\\"add()\\\">\\r\\n                                {{ 'addon.mod_forum.posttoforum' | translate }}\\r\\n                            </ion-button>\\r\\n                        </ion-col>\\r\\n                        <ion-col *ngIf=\\\"hasOffline\\\">\\r\\n                            <ion-button expand=\\\"block\\\" color=\\\"light\\\" (click)=\\\"discard()\\\">{{ 'core.discard' | translate }}</ion-button>\\r\\n                        </ion-col>\\r\\n                    </ion-row>\\r\\n                </ion-label>\\r\\n            </ion-item>\\r\\n        </form>\\r\\n    </core-loading>\\r\\n</ion-content>\\r\\n\";","// (C) Copyright 2015 Moodle Pty Ltd.\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\n\r\nimport { AddonModForumComponentsModule } from '@addons/mod/forum/components/components.module';\r\nimport { CanLeaveGuard } from '@guards/can-leave';\r\nimport { CoreEditorComponentsModule } from '@features/editor/components/components.module';\r\nimport { CoreSharedModule } from '@/core/shared.module';\r\n\r\nimport { AddonModForumNewDiscussionPage } from './new-discussion.page';\r\n\r\nconst routes: Routes = [{\r\n    path: '',\r\n    component: AddonModForumNewDiscussionPage,\r\n    canDeactivate: [CanLeaveGuard],\r\n}];\r\n\r\n@NgModule({\r\n    imports: [\r\n        RouterModule.forChild(routes),\r\n        CoreSharedModule,\r\n        AddonModForumComponentsModule,\r\n        CoreEditorComponentsModule,\r\n    ],\r\n    declarations: [\r\n        AddonModForumNewDiscussionPage,\r\n    ],\r\n})\r\nexport class AddonForumNewDiscussionPageModule {}\r\n","// (C) Copyright 2015 Moodle Pty Ltd.\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { Component, OnDestroy, ViewChild, ElementRef, OnInit, Optional } from '@angular/core';\r\nimport { FileEntry } from '@ionic-native/file/ngx';\r\nimport { FormControl } from '@angular/forms';\r\nimport { CoreEvents, CoreEventObserver } from '@singletons/events';\r\nimport { CoreGroup, CoreGroups, CoreGroupsProvider } from '@services/groups';\r\nimport { CoreNavigator } from '@services/navigator';\r\nimport {\r\n    AddonModForum,\r\n    AddonModForumAccessInformation,\r\n    AddonModForumCanAddDiscussion,\r\n    AddonModForumData,\r\n    AddonModForumProvider,\r\n} from '@addons/mod/forum/services/forum';\r\nimport { CoreEditorRichTextEditorComponent } from '@features/editor/components/rich-text-editor/rich-text-editor';\r\nimport { AddonModForumSync, AddonModForumSyncProvider } from '@addons/mod/forum/services/forum-sync';\r\nimport { CoreSites } from '@services/sites';\r\nimport { CoreDomUtils } from '@services/utils/dom';\r\nimport { Translate } from '@singletons';\r\nimport { CoreSync } from '@services/sync';\r\nimport { AddonModForumDiscussionOptions, AddonModForumOffline } from '@addons/mod/forum/services/forum-offline';\r\nimport { CoreUtils } from '@services/utils/utils';\r\nimport { AddonModForumHelper } from '@addons/mod/forum/services/forum-helper';\r\nimport { IonRefresher } from '@ionic/angular';\r\nimport { CoreFileUploader } from '@features/fileuploader/services/fileuploader';\r\nimport { CoreTextUtils } from '@services/utils/text';\r\nimport { CanLeave } from '@guards/can-leave';\r\nimport { CoreSplitViewComponent } from '@components/split-view/split-view';\r\nimport { CoreForms } from '@singletons/form';\r\n\r\ntype NewDiscussionData = {\r\n    subject: string;\r\n    message: string | null; // Null means empty or just white space.\r\n    postToAllGroups: boolean;\r\n    groupId: number;\r\n    subscribe: boolean;\r\n    pin: boolean;\r\n    files: FileEntry[];\r\n};\r\n\r\n/**\r\n * Page that displays the new discussion form.\r\n */\r\n@Component({\r\n    selector: 'page-addon-mod-forum-new-discussion',\r\n    templateUrl: 'new-discussion.html',\r\n})\r\nexport class AddonModForumNewDiscussionPage implements OnInit, OnDestroy, CanLeave {\r\n\r\n    @ViewChild('newDiscFormEl') formElement!: ElementRef;\r\n    @ViewChild(CoreEditorRichTextEditorComponent) messageEditor!: CoreEditorRichTextEditorComponent;\r\n\r\n    component = AddonModForumProvider.COMPONENT;\r\n    messageControl = new FormControl();\r\n    groupsLoaded = false;\r\n    showGroups = false;\r\n    hasOffline = false;\r\n    canCreateAttachments = true; // Assume we can by default.\r\n    canPin = false;\r\n    forum!: AddonModForumData;\r\n    showForm = false;\r\n    groups: CoreGroup[] = [];\r\n    groupIds: number[] = [];\r\n    newDiscussion: NewDiscussionData = {\r\n        subject: '',\r\n        message: null,\r\n        postToAllGroups: false,\r\n        groupId: 0,\r\n        subscribe: true,\r\n        pin: false,\r\n        files: [],\r\n    };\r\n\r\n    advanced = false; // Display all form fields.\r\n    accessInfo: AddonModForumAccessInformation = {};\r\n    courseId!: number;\r\n\r\n    protected cmId!: number;\r\n    protected forumId!: number;\r\n    protected timeCreated!: number;\r\n    protected syncId!: string;\r\n    protected syncObserver?: CoreEventObserver;\r\n    protected isDestroyed = false;\r\n    protected originalData?: Partial<NewDiscussionData>;\r\n    protected forceLeave = false;\r\n\r\n    constructor(@Optional() protected splitView: CoreSplitViewComponent) {}\r\n\r\n    /**\r\n     * Component being initialized.\r\n     */\r\n    ngOnInit(): void {\r\n        this.courseId = CoreNavigator.getRouteNumberParam('courseId')!;\r\n        this.cmId = CoreNavigator.getRouteNumberParam('cmId')!;\r\n        this.forumId = CoreNavigator.getRouteNumberParam('forumId')!;\r\n        this.timeCreated = CoreNavigator.getRouteNumberParam('timeCreated')!;\r\n\r\n        this.fetchDiscussionData().finally(() => {\r\n            this.groupsLoaded = true;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * User entered the page that contains the component.\r\n     */\r\n    ionViewDidEnter(): void {\r\n        if (this.syncObserver) {\r\n            // Already setup.\r\n            return;\r\n        }\r\n\r\n        // Refresh data if this discussion is synchronized automatically.\r\n        this.syncObserver = CoreEvents.on(AddonModForumSyncProvider.AUTO_SYNCED, data => {\r\n            if (data.forumId == this.forumId && data.userId == CoreSites.getCurrentSiteUserId()) {\r\n                CoreDomUtils.showAlertTranslated('core.notice', 'core.contenteditingsynced');\r\n                this.returnToDiscussions();\r\n            }\r\n        }, CoreSites.getCurrentSiteId());\r\n    }\r\n\r\n    /**\r\n     * Fetch if forum uses groups and the groups it uses.\r\n     *\r\n     * @param refresh Whether we're refreshing data.\r\n     * @return Promise resolved when done.\r\n     */\r\n    protected async fetchDiscussionData(refresh?: boolean): Promise<void> {\r\n        try {\r\n            const mode = await CoreGroups.getActivityGroupMode(this.cmId);\r\n            const promises: Promise<unknown>[] = [];\r\n\r\n            if (mode === CoreGroupsProvider.SEPARATEGROUPS || mode === CoreGroupsProvider.VISIBLEGROUPS) {\r\n                promises.push(\r\n                    CoreGroups.instance\r\n                        .getActivityAllowedGroups(this.cmId)\r\n                        .then((result) => {\r\n                            let promise;\r\n                            if (mode === CoreGroupsProvider.VISIBLEGROUPS) {\r\n                                // We need to check which of the returned groups the user can post to.\r\n                                promise = this.validateVisibleGroups(result.groups);\r\n                            } else {\r\n                                // WS already filters groups, no need to do it ourselves. Add \"All participants\" if needed.\r\n                                promise = this.addAllParticipantsOption(result.groups, true);\r\n                            }\r\n\r\n                            // eslint-disable-next-line promise/no-nesting\r\n                            return promise.then((forumGroups) => {\r\n                                if (forumGroups.length > 0) {\r\n                                    this.groups = forumGroups;\r\n                                    this.groupIds = forumGroups.map((group) => group.id).filter((id) => id > 0);\r\n                                    // Do not override group id.\r\n                                    this.newDiscussion.groupId = this.newDiscussion.groupId || forumGroups[0].id;\r\n                                    this.showGroups = true;\r\n                                    if (this.groupIds.length <= 1) {\r\n                                        this.newDiscussion.postToAllGroups = false;\r\n                                    }\r\n\r\n                                    return;\r\n                                } else {\r\n                                    const message = mode === CoreGroupsProvider.SEPARATEGROUPS ?\r\n                                        'addon.mod_forum.cannotadddiscussionall' : 'addon.mod_forum.cannotadddiscussion';\r\n\r\n                                    throw new Error(Translate.instant(message));\r\n                                }\r\n                            });\r\n                        }),\r\n                );\r\n            } else {\r\n                this.showGroups = false;\r\n                this.newDiscussion.postToAllGroups = false;\r\n\r\n                // Use the canAddDiscussion WS to check if the user can add attachments and pin discussions.\r\n                promises.push(\r\n                    CoreUtils.ignoreErrors(\r\n                        AddonModForum.instance\r\n                            .canAddDiscussionToAll(this.forumId, { cmId: this.cmId })\r\n                            .then((response) => {\r\n                                this.canPin = !!response.canpindiscussions;\r\n                                this.canCreateAttachments = !!response.cancreateattachment;\r\n\r\n                                return;\r\n                            }),\r\n                    ),\r\n                );\r\n            }\r\n\r\n            // Get forum.\r\n            promises.push(AddonModForum.getForum(this.courseId, this.cmId).then((forum) => this.forum = forum));\r\n\r\n            // Get access information.\r\n            promises.push(\r\n                AddonModForum.instance\r\n                    .getAccessInformation(this.forumId, { cmId: this.cmId })\r\n                    .then((accessInfo) => this.accessInfo = accessInfo),\r\n            );\r\n\r\n            await Promise.all(promises);\r\n\r\n            // If editing a discussion, get offline data.\r\n            if (this.timeCreated && !refresh) {\r\n                this.syncId = AddonModForumSync.getForumSyncId(this.forumId);\r\n\r\n                await AddonModForumSync.waitForSync(this.syncId).then(() => {\r\n                    // Do not block if the scope is already destroyed.\r\n                    if (!this.isDestroyed) {\r\n                        CoreSync.blockOperation(AddonModForumProvider.COMPONENT, this.syncId);\r\n                    }\r\n\r\n                    // eslint-disable-next-line promise/no-nesting\r\n                    return AddonModForumOffline.instance\r\n                        .getNewDiscussion(this.forumId, this.timeCreated)\r\n                        .then(async (discussion) => {\r\n                            this.hasOffline = true;\r\n                            discussion.options = discussion.options || {};\r\n                            if (discussion.groupid == AddonModForumProvider.ALL_GROUPS) {\r\n                                this.newDiscussion.groupId = this.groups[0].id;\r\n                                this.newDiscussion.postToAllGroups = true;\r\n                            } else {\r\n                                this.newDiscussion.groupId = discussion.groupid;\r\n                                this.newDiscussion.postToAllGroups = false;\r\n                            }\r\n                            this.newDiscussion.subject = discussion.subject;\r\n                            this.newDiscussion.message = discussion.message;\r\n                            this.newDiscussion.subscribe = !!discussion.options.discussionsubscribe;\r\n                            this.newDiscussion.pin = !!discussion.options.discussionpinned;\r\n                            this.messageControl.setValue(discussion.message);\r\n\r\n                            // Treat offline attachments if any.\r\n                            if (typeof discussion.options.attachmentsid === 'object' && discussion.options.attachmentsid.offline) {\r\n                                const files = await AddonModForumHelper.getNewDiscussionStoredFiles(\r\n                                    this.forumId,\r\n                                    this.timeCreated,\r\n                                );\r\n\r\n                                this.newDiscussion.files = files;\r\n                            }\r\n\r\n                            // Show advanced fields by default if any of them has not the default value.\r\n                            if (\r\n                                !this.newDiscussion.subscribe ||\r\n                                this.newDiscussion.pin ||\r\n                                this.newDiscussion.files.length ||\r\n                                this.groups.length > 0 && this.newDiscussion.groupId != this.groups[0].id ||\r\n                                this.newDiscussion.postToAllGroups\r\n                            ) {\r\n                                this.advanced = true;\r\n                            }\r\n\r\n                            return;\r\n                        });\r\n                });\r\n            }\r\n\r\n            if (!this.originalData) {\r\n                // Initialize original data.\r\n                this.originalData = {\r\n                    subject: this.newDiscussion.subject,\r\n                    message: this.newDiscussion.message,\r\n                    files: this.newDiscussion.files.slice(),\r\n                };\r\n            }\r\n\r\n            this.showForm = true;\r\n        } catch (error) {\r\n            CoreDomUtils.showErrorModalDefault(error, 'addon.mod_forum.errorgetgroups', true);\r\n\r\n            this.showForm = false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Validate which of the groups returned by getActivityAllowedGroups in visible groups should be shown to post to.\r\n     *\r\n     * @param forumGroups Forum groups.\r\n     * @return Promise resolved with the list of groups.\r\n     */\r\n    protected async validateVisibleGroups(forumGroups: CoreGroup[]): Promise<CoreGroup[]> {\r\n        let response: AddonModForumCanAddDiscussion;\r\n\r\n        // We first check if the user can post to all the groups.\r\n        try {\r\n            response = await AddonModForum.canAddDiscussionToAll(this.forumId, { cmId: this.cmId });\r\n        } catch (error) {\r\n            // The call failed, let's assume he can't.\r\n            response = {\r\n                status: false,\r\n                canpindiscussions: false,\r\n                cancreateattachment: true,\r\n            };\r\n        }\r\n\r\n        this.canPin = !!response.canpindiscussions;\r\n        this.canCreateAttachments = !!response.cancreateattachment;\r\n\r\n        // The user can post to all groups, add the \"All participants\" option and return them all.\r\n        if (response.status) {\r\n            return this.addAllParticipantsOption(forumGroups, false);\r\n        }\r\n\r\n        // The user can't post to all groups, let's check which groups he can post to.\r\n        const promises: Promise<unknown>[] = [];\r\n        const filtered: CoreGroup[] = [];\r\n\r\n        forumGroups.forEach((group) => {\r\n            promises.push(\r\n                AddonModForum.instance\r\n                    .canAddDiscussion(this.forumId, group.id, { cmId: this.cmId })\r\n\r\n                    // The call failed, let's return true so the group is shown.\r\n                    // If the user can't post to it an error will be shown when he tries to add the discussion.\r\n                    .catch(() =>({ status: true }))\r\n\r\n                    .then((response) => {\r\n                        if (response.status) {\r\n                            filtered.push(group);\r\n                        }\r\n\r\n                        return;\r\n                    }),\r\n            );\r\n        });\r\n\r\n        await Promise.all(promises);\r\n\r\n        return filtered;\r\n    }\r\n\r\n    /**\r\n     * Filter forum groups, returning only those that are inside user groups.\r\n     *\r\n     * @param forumGroups Forum groups.\r\n     * @param userGroups User groups.\r\n     * @return Filtered groups.\r\n     */\r\n    protected filterGroups(forumGroups: CoreGroup[], userGroups: CoreGroup[]): CoreGroup[] {\r\n        const userGroupsIds = userGroups.map(group => group.id);\r\n\r\n        return forumGroups.filter(forumGroup => userGroupsIds.indexOf(forumGroup.id) > -1);\r\n    }\r\n\r\n    /**\r\n     * Add the \"All participants\" option to a list of groups if the user can add a discussion to all participants.\r\n     *\r\n     * @param groups Groups.\r\n     * @param check True to check if the user can add a discussion to all participants.\r\n     * @return Promise resolved with the list of groups.\r\n     */\r\n    protected addAllParticipantsOption(groups: CoreGroup[], check: boolean): Promise<CoreGroup[]> {\r\n        if (!AddonModForum.isAllParticipantsFixed()) {\r\n            // All participants has a bug, don't add it.\r\n            return Promise.resolve(groups);\r\n        }\r\n\r\n        let promise;\r\n\r\n        if (check) {\r\n            // We need to check if the user can add a discussion to all participants.\r\n            promise = AddonModForum.canAddDiscussionToAll(this.forumId, { cmId: this.cmId }).then((response) => {\r\n                this.canPin = !!response.canpindiscussions;\r\n                this.canCreateAttachments = !!response.cancreateattachment;\r\n\r\n                return response.status;\r\n            }).catch(() =>\r\n                // The call failed, let's assume he can't.\r\n                false);\r\n        } else {\r\n            // No need to check, assume the user can.\r\n            promise = Promise.resolve(true);\r\n        }\r\n\r\n        return promise.then((canAdd) => {\r\n            if (canAdd) {\r\n                groups.unshift({\r\n                    courseid: this.courseId,\r\n                    id: AddonModForumProvider.ALL_PARTICIPANTS,\r\n                    name: Translate.instant('core.allparticipants'),\r\n                });\r\n            }\r\n\r\n            return groups;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Pull to refresh.\r\n     *\r\n     * @param refresher Refresher.\r\n     */\r\n    refreshGroups(refresher?: IonRefresher): void {\r\n        const promises = [\r\n            CoreGroups.invalidateActivityGroupMode(this.cmId),\r\n            CoreGroups.invalidateActivityAllowedGroups(this.cmId),\r\n            AddonModForum.invalidateCanAddDiscussion(this.forumId),\r\n        ];\r\n\r\n        Promise.all(promises).finally(() => {\r\n            this.fetchDiscussionData(true).finally(() => {\r\n                refresher?.complete();\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Convenience function to update or return to discussions depending on device.\r\n     *\r\n     * @param discussionIds Ids of the new discussions.\r\n     * @param discTimecreated The time created of the discussion (if offline).\r\n     */\r\n    protected returnToDiscussions(discussionIds?: number[] | null, discTimecreated?: number): void {\r\n        this.forceLeave = true;\r\n\r\n        // Delete the local files from the tmp folder.\r\n        CoreFileUploader.clearTmpFiles(this.newDiscussion.files);\r\n\r\n        CoreEvents.trigger(\r\n            AddonModForumProvider.NEW_DISCUSSION_EVENT,\r\n            {\r\n                forumId: this.forumId,\r\n                cmId: this.cmId,\r\n                discussionIds: discussionIds,\r\n                discTimecreated: discTimecreated,\r\n            },\r\n            CoreSites.getCurrentSiteId(),\r\n        );\r\n\r\n        if (this.splitView?.outletActivated) {\r\n            // Empty form.\r\n            this.hasOffline = false;\r\n            this.newDiscussion.subject = '';\r\n            this.newDiscussion.message = null;\r\n            this.newDiscussion.files = [];\r\n            this.newDiscussion.postToAllGroups = false;\r\n            this.messageEditor.clearText();\r\n            this.originalData = CoreUtils.clone(this.newDiscussion);\r\n        } else {\r\n            CoreNavigator.back();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Message changed.\r\n     *\r\n     * @param text The new text.\r\n     */\r\n    onMessageChange(text: string): void {\r\n        this.newDiscussion.message = text;\r\n    }\r\n\r\n    /**\r\n     * Add a new discussion.\r\n     */\r\n    async add(): Promise<void> {\r\n        const forumName = this.forum.name;\r\n        const subject = this.newDiscussion.subject;\r\n        let message = this.newDiscussion.message || '';\r\n        const pin = this.newDiscussion.pin;\r\n        const attachments = this.newDiscussion.files;\r\n        const discTimecreated = this.timeCreated || Date.now();\r\n        const options: AddonModForumDiscussionOptions = {\r\n            discussionsubscribe: !!this.newDiscussion.subscribe,\r\n        };\r\n\r\n        if (!subject) {\r\n            CoreDomUtils.showErrorModal('addon.mod_forum.erroremptysubject', true);\r\n\r\n            return;\r\n        }\r\n        if (!message) {\r\n            CoreDomUtils.showErrorModal('addon.mod_forum.erroremptymessage', true);\r\n\r\n            return;\r\n        }\r\n\r\n        const modal = await CoreDomUtils.showModalLoading('core.sending', true);\r\n\r\n        // Add some HTML to the message if needed.\r\n        message = CoreTextUtils.formatHtmlLines(message);\r\n\r\n        if (pin) {\r\n            options.discussionpinned = true;\r\n        }\r\n\r\n        const groupIds = this.newDiscussion.postToAllGroups ? this.groupIds : [this.newDiscussion.groupId];\r\n\r\n        try {\r\n            const discussionIds = await AddonModForumHelper.addNewDiscussion(\r\n                this.forumId,\r\n                forumName,\r\n                this.courseId,\r\n                subject,\r\n                message,\r\n                attachments,\r\n                options,\r\n                groupIds,\r\n                discTimecreated,\r\n            );\r\n\r\n            if (discussionIds) {\r\n                // Data sent to server, delete stored files (if any).\r\n                AddonModForumHelper.deleteNewDiscussionStoredFiles(this.forumId, discTimecreated);\r\n\r\n                CoreEvents.trigger(CoreEvents.ACTIVITY_DATA_SENT, { module: 'forum' });\r\n            }\r\n\r\n            if (discussionIds && discussionIds.length < groupIds.length) {\r\n                // Some discussions could not be created.\r\n                CoreDomUtils.showErrorModalDefault(null, 'addon.mod_forum.errorposttoallgroups', true);\r\n            }\r\n\r\n            CoreForms.triggerFormSubmittedEvent(\r\n                this.formElement,\r\n                !!discussionIds,\r\n                CoreSites.getCurrentSiteId(),\r\n            );\r\n\r\n            this.returnToDiscussions(discussionIds, discTimecreated);\r\n        } catch (error) {\r\n            CoreDomUtils.showErrorModalDefault(error, 'addon.mod_forum.cannotcreatediscussion', true);\r\n        } finally {\r\n            modal.dismiss();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Discard an offline saved discussion.\r\n     */\r\n    async discard(): Promise<void> {\r\n        try {\r\n            await CoreDomUtils.showConfirm(Translate.instant('core.areyousure'));\r\n\r\n            const promises: Promise<unknown>[] = [];\r\n\r\n            promises.push(AddonModForumOffline.deleteNewDiscussion(this.forumId, this.timeCreated));\r\n            promises.push(\r\n                CoreUtils.ignoreErrors(\r\n                    AddonModForumHelper.deleteNewDiscussionStoredFiles(this.forumId, this.timeCreated),\r\n                ),\r\n            );\r\n\r\n            await Promise.all(promises);\r\n\r\n            CoreForms.triggerFormCancelledEvent(this.formElement, CoreSites.getCurrentSiteId());\r\n\r\n            this.returnToDiscussions();\r\n        } catch (error) {\r\n            // Cancelled.\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Show or hide advanced form fields.\r\n     */\r\n    toggleAdvanced(): void {\r\n        this.advanced = !this.advanced;\r\n    }\r\n\r\n    /**\r\n     * Check if we can leave the page or not.\r\n     *\r\n     * @return Resolved if we can leave it, rejected if not.\r\n     */\r\n    async canLeave(): Promise<boolean> {\r\n        if (this.forceLeave) {\r\n            return true;\r\n        }\r\n\r\n        if (AddonModForumHelper.hasPostDataChanged(this.newDiscussion, this.originalData)) {\r\n            // Show confirmation if some data has been modified.\r\n            await CoreDomUtils.showConfirm(Translate.instant('core.confirmcanceledit'));\r\n        }\r\n\r\n        // Delete the local files from the tmp folder.\r\n        CoreFileUploader.clearTmpFiles(this.newDiscussion.files);\r\n\r\n        if (this.formElement) {\r\n            CoreForms.triggerFormCancelledEvent(this.formElement, CoreSites.getCurrentSiteId());\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Runs when the page is about to leave and no longer be the active page.\r\n     */\r\n    ionViewWillLeave(): void {\r\n        this.syncObserver && this.syncObserver.off();\r\n        delete this.syncObserver;\r\n    }\r\n\r\n    /**\r\n     * Page destroyed.\r\n     */\r\n    ngOnDestroy(): void {\r\n        if (this.syncId) {\r\n            CoreSync.unblockOperation(AddonModForumProvider.COMPONENT, this.syncId);\r\n        }\r\n        this.isDestroyed = true;\r\n    }\r\n\r\n}\r\n"],"sourceRoot":"webpack:///"}